<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sandu.company.dao.CompanyDesignerDao">

  <select id="getTopDesigner"  resultType="com.sandu.company.model.vo.CompanyDesignerVo"
      parameterType="com.sandu.company.model.query.CompanyDesignerQuery">
	SELECT a.id as user_id,a.sex,a.user_name as designer_name,cs.id as shop_id, cs.shop_name, b.pic_path,cs.working_years
	 FROM sys_user a
	LEFT JOIN company_shop cs on cs.user_id = a.id and cs.display_status = 1 and cs.is_deleted = 0
	LEFT JOIN res_pic b on cs.logo_pic_id = b.id
	WHERE a.user_Type = 5
	 and cs.business_type !=3
     AND a.company_id = #{companyId}
     and a.is_deleted = 0
     AND find_in_set('${platformValue}',cs.release_platform_values)
     GROUP BY cs.user_id
     order by a.visitors_render_times desc
	</select>

    <select id="getDesignerCount"  resultType="int" parameterType="com.sandu.company.model.query.CompanyDesignerQuery">
        SELECT COUNT(DISTINCT a.id) FROM  sys_user a
        LEFT JOIN company_shop cs on cs.user_id = a.id and cs.display_status = 1 and cs.is_deleted = 0
        WHERE a.user_Type = 5
        and cs.business_type !=3
        AND a.company_id = #{companyId}
        AND find_in_set('${platformValue}',cs.release_platform_values)
        and a.is_deleted = 0
    </select>
</mapper>