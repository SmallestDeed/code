<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sandu.company.dao.CompanyDesignerDao">

  <select id="getTopDesigner"  resultType="com.sandu.company.model.vo.CompanyDesignerVo"
      parameterType="long">
	SELECT a.id as user_id,a.sex,a.user_name as designer_name,cs.id as shop_id, cs.shop_name, b.pic_path
	 FROM sys_user a
	LEFT JOIN company_shop cs on cs.user_id = a.id and cs.display_status = 1 and cs.is_deleted = 0
	LEFT JOIN res_pic b on cs.logo_pic_id = b.id
	WHERE a.user_Type = 5
	 and cs.business_type !=3
     AND a.company_id = #{companyId}
     and a.is_deleted = 0
     order by a.visitors_render_times desc limit 0,20;
	</select>

    <select id="getDesignerCount"  resultType="int" parameterType="long">
        SELECT COUNT(DISTINCT a.id) FROM  sys_user a
        LEFT JOIN company_shop cs on cs.user_id = a.id and cs.display_status = 1 and cs.is_deleted = 0
        WHERE a.user_Type = 5
        and cs.business_type !=3
        AND a.company_id = #{companyId}
        and a.is_deleted = 0
    </select>
</mapper>