<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sandu.service.companyshop.dao.CompanyshopMapper">
    <resultMap id="BaseResultMap" type="com.sandu.api.companyshop.model.Companyshop">
        <id column="id" jdbcType="INTEGER" property="id"/>
        <result column="id" jdbcType="INTEGER" property="id"/>
        <result column="company_id" jdbcType="INTEGER" property="companyId"/>
        <result column="user_id" jdbcType="INTEGER" property="userId"/>
        <result column="shop_code" jdbcType="VARCHAR" property="shopCode"/>
        <result column="shop_name" jdbcType="VARCHAR" property="shopName"/>
        <result column="business_type" jdbcType="INTEGER" property="businessType"/>
        <result column="province_code" jdbcType="VARCHAR" property="provinceCode"/>
        <result column="city_code" jdbcType="VARCHAR" property="cityCode"/>
        <result column="area_code" jdbcType="VARCHAR" property="areaCode"/>
        <result column="street_code" jdbcType="VARCHAR" property="streetCode"/>
        <result column="long_area_code" jdbcType="VARCHAR" property="longAreaCode"/>
        <result column="shop_address" jdbcType="VARCHAR" property="shopAddress"/>
        <result column="contact_phone" jdbcType="VARCHAR" property="contactPhone"/>
        <result column="contact_name" jdbcType="VARCHAR" property="contactName"/>
        <result column="logo_pic_id" jdbcType="INTEGER" property="logoPicId"/>
        <result column="cover_res_ids" jdbcType="VARCHAR" property="coverResIds"/>
        <result column="cover_res_type" jdbcType="INTEGER" property="coverResType"/>
        <result column="introduced_file_id" jdbcType="INTEGER" property="introducedFileId"/>
        <result column="release_platform_values" jdbcType="VARCHAR" property="releasePlatformValues"/>
        <result column="display_status" jdbcType="INTEGER" property="displayStatus"/>
        <result column="visit_count" jdbcType="INTEGER" property="visitCount"/>
        <result column="praise_rate" jdbcType="VARCHAR" property="praiseRate"/>
        <result column="shop_introduced" jdbcType="VARCHAR" property="shopIntroduced"/>
        <result column="sys_code" jdbcType="VARCHAR" property="sysCode"/>
        <result column="creator" jdbcType="VARCHAR" property="creator"/>
        <result column="gmt_create" jdbcType="TIMESTAMP" property="gmtCreate"/>
        <result column="modifier" jdbcType="VARCHAR" property="modifier"/>
        <result column="gmt_modified" jdbcType="TIMESTAMP" property="gmtModified"/>
        <result column="is_deleted" jdbcType="INTEGER" property="isDeleted"/>
        <result column="remark" jdbcType="VARCHAR" property="remark"/>
        <result column="category_ids" jdbcType="VARCHAR" property="categoryIds"/>
        <result column="first_category_ids" jdbcType="VARCHAR" property="firstCategoryIds"/>
        <result column="company_pid" jdbcType="INTEGER" property="companyPid"/>
        <result column="design_fee_starting" jdbcType="VARCHAR" property="designFeeStarting"/>
        <result column="design_fee_ending" jdbcType="VARCHAR" property="designFeeEnding"/>
        <result column="longitude" jdbcType="VARCHAR" property="longitude"/>
        <result column="latitude" jdbcType="VARCHAR" property="latitude"/>
        <result column="recommended_time" property="recommendedTime"/>
    </resultMap>

    <sql id="Base_Column_List">
        id,company_id,user_id,shop_code,shop_name,business_type,province_code,city_code,area_code,street_code,long_area_code,shop_address,contact_phone,contact_name,logo_pic_id,cover_res_ids,cover_res_type,introduced_file_id,release_platform_values,display_status,visit_count,praise_rate,shop_introduced,sys_code,creator,gmt_create,modifier,gmt_modified,is_deleted,remark,category_ids,first_category_ids,company_pid,design_fee_starting,design_fee_ending,longitude,latitude,recommended_time
    </sql>

    <insert id="insert" keyProperty="id" useGeneratedKeys="true" parameterType="com.sandu.api.companyshop.model.Companyshop">
        insert into company_shop
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="companyId != null">
                company_id,
            </if>
            <if test="userId != null">
                user_id,
            </if>
            <if test="shopCode != null">
                shop_code,
            </if>
            <if test="shopName != null">
                shop_name,
            </if>
            <if test="businessType != null">
                business_type,
            </if>
            <if test="provinceCode != null">
                province_code,
            </if>
            <if test="cityCode != null">
                city_code,
            </if>
            <if test="areaCode != null">
                area_code,
            </if>
            <if test="streetCode != null">
                street_code,
            </if>
            <if test="longAreaCode != null">
                long_area_code,
            </if>
            <if test="shopAddress != null">
                shop_address,
            </if>
            <if test="contactPhone != null">
                contact_phone,
            </if>
            <if test="contactName != null">
                contact_name,
            </if>
            <if test="logoPicId != null">
                logo_pic_id,
            </if>
            <if test="coverResIds != null">
                cover_res_ids,
            </if>
            <if test="coverResType != null">
                cover_res_type,
            </if>
            <if test="introducedFileId != null">
                introduced_file_id,
            </if>
            <if test="releasePlatformValues != null">
                release_platform_values,
            </if>
            <if test="displayStatus != null">
                display_status,
            </if>
            <if test="visitCount != null">
                visit_count,
            </if>
            <if test="praiseRate != null">
                praise_rate,
            </if>
            <if test="shopIntroduced != null">
                shop_introduced,
            </if>
            <if test="sysCode != null">
                sys_code,
            </if>
            <if test="creator != null">
                creator,
            </if>
            <if test="gmtCreate != null">
                gmt_create,
            </if>
            <if test="modifier != null">
                modifier,
            </if>
            <if test="gmtModified != null">
                gmt_modified,
            </if>
            <if test="isDeleted != null">
                is_deleted,
            </if>
            <if test="remark != null">
                remark,
            </if>
            <if test="categoryIds != null">
                category_ids,
            </if>
            <if test="firstCategoryIds != null">
                first_category_ids,
            </if>
            <if test="companyPid != null">
                company_pid,
            </if>
            <if test="designFeeStarting != null">
                design_fee_starting,
            </if>
            <if test="designFeeEnding != null">
                design_fee_ending,
            </if>
            <if test="longitude != null">
                longitude,
            </if>
            <if test="latitude != null">
                latitude,
            </if>
            <if test="recommendedTime != null">
                recommended_time,
            </if>
            <if test="offlineShopId != null">
                offline_shop_id,
            </if>
            <if test="shopType != null">
                shop_type,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=INTEGER},
            </if>
            <if test="companyId != null">
                #{companyId,jdbcType=INTEGER},
            </if>
            <if test="userId != null">
                #{userId,jdbcType=INTEGER},
            </if>
            <if test="shopCode != null">
                #{shopCode,jdbcType=VARCHAR},
            </if>
            <if test="shopName != null">
                #{shopName,jdbcType=VARCHAR},
            </if>
            <if test="businessType != null">
                #{businessType,jdbcType=INTEGER},
            </if>
            <if test="provinceCode != null">
                #{provinceCode,jdbcType=VARCHAR},
            </if>
            <if test="cityCode != null">
                #{cityCode,jdbcType=VARCHAR},
            </if>
            <if test="areaCode != null">
                #{areaCode,jdbcType=VARCHAR},
            </if>
            <if test="streetCode != null">
                #{streetCode,jdbcType=VARCHAR},
            </if>
            <if test="longAreaCode != null">
                #{longAreaCode,jdbcType=VARCHAR},
            </if>
            <if test="shopAddress != null">
                #{shopAddress,jdbcType=VARCHAR},
            </if>
            <if test="contactPhone != null">
                #{contactPhone,jdbcType=VARCHAR},
            </if>
            <if test="contactName != null">
                #{contactName,jdbcType=VARCHAR},
            </if>
            <if test="logoPicId != null">
                #{logoPicId,jdbcType=INTEGER},
            </if>
            <if test="coverResIds != null">
                #{coverResIds,jdbcType=VARCHAR},
            </if>
            <if test="coverResType != null">
                #{coverResType,jdbcType=INTEGER},
            </if>
            <if test="introducedFileId != null">
                #{introducedFileId,jdbcType=INTEGER},
            </if>
            <if test="releasePlatformValues != null">
                #{releasePlatformValues,jdbcType=VARCHAR},
            </if>
            <if test="displayStatus != null">
                #{displayStatus,jdbcType=INTEGER},
            </if>
            <if test="visitCount != null">
                #{visitCount,jdbcType=INTEGER},
            </if>
            <if test="praiseRate != null">
                #{praiseRate,jdbcType=VARCHAR},
            </if>
            <if test="shopIntroduced != null">
                #{shopIntroduced,jdbcType=VARCHAR},
            </if>
            <if test="sysCode != null">
                #{sysCode,jdbcType=VARCHAR},
            </if>
            <if test="creator != null">
                #{creator,jdbcType=VARCHAR},
            </if>
            <if test="gmtCreate != null">
                #{gmtCreate,jdbcType=TIMESTAMP},
            </if>
            <if test="modifier != null">
                #{modifier,jdbcType=VARCHAR},
            </if>
            <if test="gmtModified != null">
                #{gmtModified,jdbcType=TIMESTAMP},
            </if>
            <if test="isDeleted != null">
                #{isDeleted,jdbcType=INTEGER},
            </if>
            <if test="remark != null">
                #{remark,jdbcType=VARCHAR},
            </if>
            <if test="categoryIds != null">
                #{categoryIds,jdbcType=VARCHAR},
            </if>
            <if test="firstCategoryIds != null">
                #{firstCategoryIds,jdbcType=VARCHAR},
            </if>
            <if test="companyPid != null">
                #{companyPid,jdbcType=INTEGER},
            </if>
            <if test="designFeeStarting != null">
                #{designFeeStarting,jdbcType=VARCHAR},
            </if>
            <if test="designFeeEnding != null">
                #{designFeeEnding,jdbcType=VARCHAR},
            </if>
            <if test="longitude != null">
                #{longitude,jdbcType=VARCHAR},
            </if>
            <if test="latitude != null">
                #{latitude,jdbcType=VARCHAR},
            </if>
            <if test="recommendedTime != null">
                #{recommendedTime,jdbcType=TINYINT},
            </if>
            <if test="offlineShopId != null">
                #{offlineShopId,jdbcType=BIGINT},
            </if>
            <if test="shopType != null">
                #{shopType},
            </if>
        </trim>
    </insert>

    <update id="updateByPrimaryKey" parameterType="com.sandu.api.companyshop.model.Companyshop">
        update company_shop
        <set>
            <if test="id != null">
                id = #{id,jdbcType=INTEGER},
            </if>
            <if test="companyId != null">
                company_id = #{companyId,jdbcType=INTEGER},
            </if>
            <if test="userId != null">
                user_id = #{userId,jdbcType=INTEGER},
            </if>
            <if test="shopCode != null">
                shop_code = #{shopCode,jdbcType=VARCHAR},
            </if>
            <if test="shopName != null">
                shop_name = #{shopName,jdbcType=VARCHAR},
            </if>
            <if test="businessType != null">
                business_type = #{businessType,jdbcType=INTEGER},
            </if>
            <if test="provinceCode != null">
                province_code = #{provinceCode,jdbcType=VARCHAR},
            </if>
            <if test="cityCode != null">
                city_code = #{cityCode,jdbcType=VARCHAR},
            </if>
            <if test="areaCode != null">
                area_code = #{areaCode,jdbcType=VARCHAR},
            </if>
            <if test="streetCode != null">
                street_code = #{streetCode,jdbcType=VARCHAR},
            </if>
            <if test="longAreaCode != null">
                long_area_code = #{longAreaCode,jdbcType=VARCHAR},
            </if>
            <if test="shopAddress != null">
                shop_address = #{shopAddress,jdbcType=VARCHAR},
            </if>
            <if test="contactPhone != null">
                contact_phone = #{contactPhone,jdbcType=VARCHAR},
            </if>
            <if test="contactName != null">
                contact_name = #{contactName,jdbcType=VARCHAR},
            </if>
            <if test="logoPicId != null">
                logo_pic_id = #{logoPicId,jdbcType=INTEGER},
            </if>
            <if test="coverResIds != null">
                cover_res_ids = #{coverResIds,jdbcType=VARCHAR},
            </if>
            <if test="coverResType != null">
                cover_res_type = #{coverResType,jdbcType=INTEGER},
            </if>
            <if test="introducedFileId != null">
                introduced_file_id = #{introducedFileId,jdbcType=INTEGER},
            </if>
            <if test="releasePlatformValues != null">
                release_platform_values = #{releasePlatformValues,jdbcType=VARCHAR},
            </if>
            <if test="displayStatus != null">
                display_status = #{displayStatus,jdbcType=INTEGER},
            </if>
            <if test="visitCount != null">
                visit_count = #{visitCount,jdbcType=INTEGER},
            </if>
            <if test="praiseRate != null">
                praise_rate = #{praiseRate,jdbcType=VARCHAR},
            </if>
            <if test="shopIntroduced != null">
                shop_introduced = #{shopIntroduced,jdbcType=VARCHAR},
            </if>
            <if test="sysCode != null">
                sys_code = #{sysCode,jdbcType=VARCHAR},
            </if>
            <if test="creator != null">
                creator = #{creator,jdbcType=VARCHAR},
            </if>
            <if test="gmtCreate != null">
                gmt_create = #{gmtCreate,jdbcType=TIMESTAMP},
            </if>
            <if test="modifier != null">
                modifier = #{modifier,jdbcType=VARCHAR},
            </if>
            <if test="gmtModified != null">
                gmt_modified = #{gmtModified,jdbcType=TIMESTAMP},
            </if>
            <if test="isDeleted != null">
                is_deleted = #{isDeleted,jdbcType=INTEGER},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=VARCHAR},
            </if>
            <if test="categoryIds != null">
                category_ids = #{categoryIds,jdbcType=VARCHAR},
            </if>
            <if test="firstCategoryIds != null">
                first_category_ids = #{firstCategoryIds,jdbcType=VARCHAR},
            </if>
            <if test="companyPid != null">
                company_pid = #{companyPid,jdbcType=INTEGER},
            </if>
            <if test="designFeeStarting != null">
                design_fee_starting = #{designFeeStarting,jdbcType=VARCHAR},
            </if>
            <if test="designFeeEnding != null">
                design_fee_ending = #{designFeeEnding,jdbcType=VARCHAR},
            </if>
            <if test="longitude != null">
                longitude = #{longitude,jdbcType=VARCHAR},
            </if>
            <if test="latitude != null">
                latitude = #{latitude,jdbcType=VARCHAR},
            </if>
        </set>
        where id = #{id,jdbcType=INTEGER}
    </update>

    <update id="deleteByPrimaryKey" parameterType="java.lang.Integer">
        update company_shop set is_deleted = 1
        where id IN
        <foreach separator="," open="(" close=")" collection="companyshopIds" item="companyshopId">
            #{companyshopId}
        </foreach>
    </update>
    <update id="companyshopToTop">
        update company_shop
        set recommended_time = #{topId}
        where id =#{shopId}
    </update>
    <update id="companyshopToRefresh">
        update company_shop
        set gmt_modified = now()
        where id =#{shopId}
    </update>

    <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from company_shop
        where id = #{companyshopId,jdbcType=INTEGER}
    </select>

    <select id="findAll" resultMap="BaseResultMap" parameterType="com.sandu.api.companyshop.input.CompanyshopQuery">
        select
        <include refid="Base_Column_List"/>
        from company_shop
        where is_deleted=0
        <if test="businessType != null">
            AND CONCAT(',', business_type, ',') LIKE CONCAT('%,', #{businessType}, ',%')
        </if>
        <if test="queryParam != null">
            and shop_name like concat ('%',#{queryParam},'%')
        </if>
        order by recommended_time desc,gmt_create desc
    </select>

    <select id="checkHasOfflineShop" resultType="java.lang.Integer">
      select count(*) from company_shop where is_deleted = 0 and offline_shop_id = #{shopOfflineId}
    </select>

    <select id="checkHasOfflineShop2" resultType="java.lang.Integer">
      select count(*) from company_shop where is_deleted = 0 and user_id = #{claimUserId}
    </select>
</mapper>