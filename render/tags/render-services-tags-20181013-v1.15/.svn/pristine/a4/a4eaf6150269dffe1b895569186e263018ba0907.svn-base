package com.nork.design.dao;
import java.util.List;
import com.nork.mobile.model.ProductGroupReplaceTaskDetail;
import com.nork.mobile.model.ProductReplaceTaskDetail;
import com.nork.render.model.BaseHouseGuidePicInfo;
import com.nork.render.model.BaseHousePicFullHousePlanRel;
import org.apache.ibatis.annotations.Param;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;
import com.nork.design.model.AutoRenderTask;
import com.nork.design.model.AutoRenderTaskState;
import com.nork.design.model.DesignPlan;
import com.nork.design.model.DesignTemplet;
import com.nork.home.model.BaseHouse;
import com.nork.home.model.SpaceCommon;

@Repository
@Transactional
public interface DesignPlanAutoRenderMapper {
	
	public int addTaskStateToDB(AutoRenderTaskState taskState); 
	
	public int updateAutoRenderTaskState(AutoRenderTaskState taskState);
	
	public int deleteRenderTaskByTaskId(Integer taskId); 

	public int updateTaskStateByPlanId(AutoRenderTaskState autoRenderTaskState); 
	
	List<AutoRenderTask> getAutoRenderTaskList(@Param("autoRenderTask")AutoRenderTask autoRenderTask); 
	
	List<AutoRenderTaskState> getTaskStateList(@Param("AutoRenderTaskState")AutoRenderTaskState autoRenderTaskState); 
	
	List<AutoRenderTask> getRenderTaskListByPlanId(@Param("planId")Integer planId); 
	
	List<AutoRenderTask> getRenderTaskListBytemplateId(@Param("templateId")Integer templateId); 
	
	public int  insertSelective(AutoRenderTask autoRenderTask); 
	
	int batchInsertDataList (@Param("list")List<AutoRenderTask> list);
	
	//通过方案Id从任务状态表里查
	List<AutoRenderTaskState> getTaskStateListByDesignPlanId(@Param("planId")Integer planId);
	

	//通过templateId从任务状态表里查
	List<AutoRenderTaskState> getTaskStateListByTemplateId(@Param("templateId")Integer templateId);

	public AutoRenderTaskState getTaskStateByPlanIdAndTemplateId(@Param("planId")Integer planId, @Param("templateId")Integer templateId);

	/**
	 * 根据样板房id 查询 所有自动渲染成功的  任务状态
	 * @param templateId
	 * @return
	 * add by yangzhun
	 */
	List<AutoRenderTaskState> getSuccessTaskStateList(@Param("templateId")Integer templateId);
	
	int createTask(AutoRenderTask autoRenderTask);
	
	List<AutoRenderTask> getReplaceTaskList(@Param("autoRenderTask")AutoRenderTask autoRenderTask); 
	

	/**
	 * 查询该用户的所有替换记录  add by yangzhun
	 * @param autoRenderTask
	 * @return
	 */
	List<AutoRenderTask> getALLReplaceRecordByUserId(AutoRenderTask autoRenderTask);
	/**
	 * 查询该用户的所有替换记录和方案名称的list    已经开始渲染的任务 add by yangzhun
	 * @param model
	 * @return
	 */
	List<AutoRenderTask> getAllReplaceRecordByUserId2(AutoRenderTask model);

	public int updateTaskStateByTaskId(AutoRenderTaskState autoRenderTaskState);

	/**
	 * 查询任务状态
	 * @param autoRenderTaskState add by yangzhun
	 * @return
	 */
	AutoRenderTaskState getTaskType(AutoRenderTaskState autoRenderTaskState);
	
	public AutoRenderTaskState getStateByTaskId(@Param("taskId")Integer taskId);
	
	public AutoRenderTask getRenderTaskById(@Param("taskId")Integer taskId);

	public List<AutoRenderTask> getTaskList(AutoRenderTask autoRenderTask);

    public void batchInsertProductReplaceTaskDataList(@Param("list") List<ProductReplaceTaskDetail> productReplaceList);

    void insertGroupProductReplace(ProductGroupReplaceTaskDetail productGroupReplaceTaskDetail);

    void batchInsertTextureList(@Param("list") List<ProductReplaceTaskDetail> textureReplaceList);
    
    List<AutoRenderTask> selectUnionList( AutoRenderTask autoRenderTask);
    
    Integer selectUnionCount( AutoRenderTask autoRenderTask);
    
    String getAllRenderTypesStr(AutoRenderTask autoRenderTask);
    
    boolean delRederTaskStateByDesignPlanId(AutoRenderTask autoRenderTask);

	/**
	 * 将任务致为无效，只是在前端不显示
	 * @param id
	 */
	int updateAutoRenderTaskById(@Param("id") Integer id,@Param("userId") Integer userId);
    
    /**
     * 查询用户我的方案中已使用户型
     * @param userId    用户ID
     * @return
     */
    List<BaseHouse> queryUsedHouseInMyRenderPlan(@Param("userId") Integer userId);
    
    /**
	 * 根据business_id 逻辑删除任务状态
	 * @param businessId
	 * @return
	 */
	void updateAutoRenderTaskStateByBusinessId(Integer businessId);
	/**
	 * 根据business_id查询任务状态
	 * @param businessId
	 * @return
	 */
	AutoRenderTaskState selectTaskStateByBusinessId(Integer businessId);

	/**
	 * 根据id查询任务状态
	 * @param id
	 * @return
	 */
	AutoRenderTaskState selectAuroRenderTaskStateById(Integer id);

	int addSubtaskList(@Param("list") List<AutoRenderTask> list);

    int updateAutoRenderTask(AutoRenderTask autoRenderTask);

	AutoRenderTaskState getFullHouseMainTaskByNewFullHouseId(Integer fullHouseId);

	int deleteSubTask(Integer taskId);

    int insertBaseHousePicFullHousePlanRel(BaseHousePicFullHousePlanRel baseHousePicFullHousePlanRel);

	List<BaseHouseGuidePicInfo> selectBaseHouseGuidePicInfo(@Param("houseId") Integer houseId,@Param("designTempletId") Integer designTempletId);

	List<BaseHousePicFullHousePlanRel> selectBaseHousePicFullHousePlanRelList(@Param("houseId") Integer houseId,
																			  @Param("designTempletId")Integer designTempletId,
																			  @Param("fullHousePlanId") Integer fullHousePlanId);

    int updateBaseHousePicFullHousePlanRel(BaseHousePicFullHousePlanRel newBaseHousePicFullHousePlanRel);

    List<BaseHouseGuidePicInfo> selectBaseHouseGuidePicInfoList(@Param("autoRenderTaskList") List<AutoRenderTask> autoRenderTaskList,@Param("houseId")Integer houseId);

	int insertBaseHousePicFullHousePlanRelList(List<BaseHousePicFullHousePlanRel> newBaseHousePicFullHousePlanRelList);

	List<AutoRenderTask>  selectALLTaskByMainTaskId(@Param("userId") Integer userId,@Param("mainTaskId") Integer mainTaskId);

    List<BaseHousePicFullHousePlanRel> getBaseHousePicFullHousePlanRelListByFullHousePlanId(@Param("fullHousePlanId") Integer fullHousePlanId);

	/**
	 * 根据全户型方案id查找关联户型id
	 * @param fullHousePlanId
	 * @return
	 */
	Integer selectHouseIdByFullHousePlanId(@Param("fullHousePlanId")Integer fullHousePlanId);

    Integer updateAutoRenderTaskStateByTaskId(@Param("taskId") Integer taskId,
											  @Param("state") Integer state);
}
