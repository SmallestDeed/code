<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.nork.design.dao.DesignTempletMapper">
<!--<cache type="org.mybatis.caches.ehcache.LoggingEhcache"/>-->
	<!-- **插入定义** -->
	<insert id="insertSelective" parameterType="com.nork.design.model.DesignTemplet"  useGeneratedKeys="true" keyProperty="id">
		insert into design_templet
		<trim prefix="(" suffix=")" suffixOverrides=",">
		<if test="designCode!= null">design_code, </if>
		<if test="designName!= null">design_name, </if>
		<if test="userId!= null">user_id, </if>
		<if test="designSourceType!= null">design_source_type, </if>
		<if test="designStyleId!= null">design_style_id, </if>
		<if test="spaceCommonId!= null">space_common_id, </if>
		<if test="configFileId!= null">config_file_id, </if>
		<if test="eveningFileId!= null">evening_file_id, </if>
		<if test="dawnFileId!= null">dawn_file_id, </if>
		<if test="nightFileId!= null">night_file_id, </if>
		<if test="modelId!= null">model_id, </if>
		<if test="model3dId!= null">model_3d_id, </if>
		<if test="webModelU3dId!= null">web_model_u3d_id, </if>
		<if test="iosModelU3dId!= null">ios_model_u3d_id, </if>
		<if test="ipadModelU3dId!= null">ipad_model_u3d_id, </if>
		<if test="pcModelU3dId!= null">pc_model_u3d_id, </if>
		<if test="androidModelU3dId!= null">android_model_u3d_id, </if>
		<if test="macBookpcModelU3dId!= null">macBookpc_model_u3d_id, </if>
		<if test="picId!= null">pic_id, </if>
		<if test="cadPicId!= null">cad_pic_id, </if>
		<if test="renderPicIds!= null">render_pic_ids, </if>
		<if test="putawayState!= null">putaway_state, </if>
	    <if test="isRecommend!= null">is_recommend, </if>
		<if test="sysCode!= null">sys_code, </if>
		<if test="creator!= null">creator, </if>
		<if test="gmtCreate!= null">gmt_create, </if>
		<if test="modifier!= null">modifier, </if>
		<if test="gmtModified!= null">gmt_modified, </if>
		<if test="isDeleted!= null">is_deleted, </if>
		<if test="fbxFileId!=null">fbx_file_id,</if>
		<if test="fbxTexture!=null">fbx_texture,</if>
		<if test="fbxState!=null">fbx_state,</if>
		<if test="remark!= null">remark, </if>
		<if test="effectPic!= null">effect_pic, </if>
		<if test="effectPlanIds!= null">effect_plan_ids, </if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
		<if test="designCode!= null">  #{designCode,jdbcType=VARCHAR}, </if>
		<if test="designName!= null">  #{designName,jdbcType=VARCHAR}, </if>
		<if test="userId!= null">  #{userId,jdbcType=INTEGER}, </if>
		<if test="designSourceType!= null">  #{designSourceType,jdbcType=VARCHAR}, </if>
		<if test="designStyleId!= null">  #{designStyleId,jdbcType=INTEGER}, </if>
		<if test="spaceCommonId!= null">#{spaceCommonId,jdbcType=INTEGER}, </if>
		<if test="configFileId!= null">  #{configFileId,jdbcType=INTEGER}, </if>
		<if test="eveningFileId!= null">  #{eveningFileId,jdbcType=INTEGER}, </if>
		<if test="dawnFileId!= null">  #{dawnFileId,jdbcType=INTEGER}, </if>
		<if test="nightFileId!= null">  #{nightFileId,jdbcType=INTEGER}, </if>
		<if test="modelId!= null">  #{modelId,jdbcType=INTEGER}, </if>
		<if test="model3dId!= null">  #{model3dId,jdbcType=INTEGER}, </if>
		<if test="webModelU3dId!= null">  #{webModelU3dId,jdbcType=INTEGER}, </if>
		<if test="iosModelU3dId!= null">  #{iosModelU3dId,jdbcType=INTEGER}, </if>
		<if test="ipadModelU3dId!= null">  #{ipadModelU3dId,jdbcType=INTEGER}, </if>
		<if test="pcModelU3dId!= null">  #{pcModelU3dId,jdbcType=INTEGER}, </if>
		<if test="androidModelU3dId!= null">  #{androidModelU3dId,jdbcType=INTEGER}, </if>
		<if test="macBookpcModelU3dId!= null">  #{macBookpcModelU3dId,jdbcType=INTEGER}, </if>
	    <if test="picId!= null">  #{picId,jdbcType=INTEGER}, </if>
	    <if test="cadPicId!= null">  #{cadPicId,jdbcType=INTEGER}, </if>
	    <if test="renderPicIds!= null">  #{renderPicIds,jdbcType=VARCHAR}, </if>
	    <if test="putawayState!= null">  #{putawayState,jdbcType=INTEGER}, </if>
		<if test="isRecommend!= null">  #{isRecommend,jdbcType=INTEGER}, </if>
		<if test="sysCode!= null">  #{sysCode,jdbcType=VARCHAR}, </if>
		<if test="creator!= null">  #{creator,jdbcType=VARCHAR}, </if>
		<if test="gmtCreate!= null">  #{gmtCreate,jdbcType=TIMESTAMP}, </if>
		<if test="modifier!= null">  #{modifier,jdbcType=VARCHAR}, </if>
		<if test="gmtModified!= null">  #{gmtModified,jdbcType=TIMESTAMP}, </if>
		<if test="isDeleted!= null">  #{isDeleted,jdbcType=INTEGER}, </if>
		<if test="remark!= null">  #{remark,jdbcType=VARCHAR}, </if>
		<if test="fbxFileId!=null">#{fbxFileId,jdbcType=VARCHAR},</if>
		<if test="fbxTexture!=null">#{fbxTexture,jdbcType=VARCHAR},</if>
		<if test="fbxState!=null">#{fbxState,jdbcType=VARCHAR},</if>
		<if test="effectPic!= null">  #{effectPic,jdbcType=VARCHAR}, </if>
		<if test="effectPlanIds!= null">  #{effectPlanIds,jdbcType=VARCHAR}, </if>
		</trim>
	</insert>

	<!-- **更新定义** -->
	<update id="updateByPrimaryKeySelective" parameterType="com.nork.design.model.DesignTemplet">
		update design_templet
		<set>
		<if test="designCode!= null">  design_code = #{designCode,jdbcType=VARCHAR}, </if>
		<if test="designName!= null">  design_name = #{designName,jdbcType=VARCHAR}, </if>
		<if test="userId!= null">  user_id = #{userId,jdbcType=INTEGER}, </if>
		<if test="designSourceType!= null">  design_source_type = #{designSourceType,jdbcType=VARCHAR}, </if>
		<if test="designStyleId!= null">  design_style_id = #{designStyleId,jdbcType=INTEGER}, </if>
		<if test="spaceCommonId!= null">  space_common_id = #{spaceCommonId,jdbcType=INTEGER}, </if>
		<if test="configFileId!= null">  config_file_id = #{configFileId,jdbcType=INTEGER}, </if>
		<if test="eveningFileId!= null">  evening_file_id = #{eveningFileId,jdbcType=INTEGER}, </if>
		<if test="dawnFileId!= null">  dawn_file_id = #{dawnFileId,jdbcType=INTEGER}, </if>
		<if test="nightFileId!= null">  night_file_id = #{nightFileId,jdbcType=INTEGER}, </if>
		<if test="model3dId!= null">  model_3d_id = #{model3dId,jdbcType=INTEGER}, </if>
		<if test="webModelU3dId!= null">  web_model_u3d_id = #{webModelU3dId,jdbcType=INTEGER}, </if>
		<if test="iosModelU3dId!= null">  ios_model_u3d_id = #{iosModelU3dId,jdbcType=INTEGER}, </if>
		<if test="pcModelU3dId!= null">  pc_model_u3d_id = #{pcModelU3dId,jdbcType=INTEGER}, </if>
		<if test="ipadModelU3dId!= null">  ipad_model_u3d_id = #{ipadModelU3dId,jdbcType=INTEGER}, </if>
		<if test="androidModelU3dId!= null">  android_model_u3d_id = #{androidModelU3dId,jdbcType=INTEGER}, </if>
		<if test="macBookpcModelU3dId!= null">  macBookpc_model_u3d_id = #{macBookpcModelU3dId,jdbcType=INTEGER}, </if>
		<if test="picId!= null">  pic_id = #{picId,jdbcType=INTEGER}, </if>
		<if test="cadPicId!= null">  cad_pic_id = #{cadPicId,jdbcType=INTEGER}, </if>
		<if test="renderPicIds!= null">  render_pic_ids = #{renderPicIds,jdbcType=VARCHAR}, </if>
		<if test="putawayState!= null">  putaway_state = #{putawayState,jdbcType=INTEGER}, </if>
		<if test="isRecommend!= null">  is_recommend = #{isRecommend,jdbcType=INTEGER}, </if>
		<if test="sysCode!= null">  sys_code = #{sysCode,jdbcType=VARCHAR}, </if>
		<if test="creator!= null">  creator = #{creator,jdbcType=VARCHAR}, </if>
		<if test="gmtCreate!= null">  gmt_create = #{gmtCreate,jdbcType=TIMESTAMP}, </if>
		<if test="modifier!= null">  modifier = #{modifier,jdbcType=VARCHAR}, </if>
		<if test="gmtModified!= null">  gmt_modified = #{gmtModified,jdbcType=TIMESTAMP}, </if>
		<if test="isDeleted!= null">  is_deleted = #{isDeleted,jdbcType=INTEGER}, </if>
		<if test="fbxFileId!=null">#{fbxFileId,jdbcType=VARCHAR},</if>
		<if test="fbxTexture!=null">#{fbxTexture,jdbcType=VARCHAR},</if>
		<if test="fbxState!=null">#{fbxState,jdbcType=VARCHAR},</if>
		<if test="remark!= null">  remark = #{remark,jdbcType=VARCHAR}, </if>
		<if test="effectPic!= null">  effect_pic = #{effectPic,jdbcType=VARCHAR}, </if>
		<if test="effectPlanIds!= null">  effect_plan_ids = #{effectPlanIds,jdbcType=VARCHAR}, </if>
		</set>
		where id = #{id,jdbcType=INTEGER}
	</update>

	<!-- **删除定义** -->
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		delete from design_templet
		where id = #{id,jdbcType=INTEGER}
	</delete>
	
		<delete id="deleteByCode" parameterType="java.lang.String">
		delete from design_templet
		where design_code = #{designCode,jdbcType=VARCHAR}
	</delete>
	
	<!-- **常量定义** -->
	<sql id="All_Column_List">
		id,design_code,design_name,user_id,design_source_type,design_style_id,space_common_id,config_file_id,model_id,model_3d_id,web_model_u3d_id,ios_model_u3d_id,ipad_model_u3d_id,
		pc_model_u3d_id,android_model_u3d_id,macBookpc_model_u3d_id,pic_id,cad_pic_id,putaway_state,render_pic_ids,is_recommend,sys_code,creator,gmt_create,modifier,gmt_modified,is_deleted,remark,effect_pic,effect_plan_ids,
		evening_file_id,dawn_file_id,night_file_id,fbx_file_id,fbx_texture,fbx_state,smallpox_identify_str,ground_identify_str,unique_id
	</sql>
	
	<!-- **结果定义** -->
	<resultMap id="AllResultMap" type="com.nork.design.model.DesignTemplet">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result  column="design_code" property="designCode" jdbcType="VARCHAR" />
		<result  column="design_name" property="designName" jdbcType="VARCHAR" />
		<result  column="user_id" property="userId" jdbcType="INTEGER" />
		<result  column="design_source_type" property="designSourceType" jdbcType="VARCHAR" />
		<result  column="design_style_id" property="designStyleId" jdbcType="INTEGER" />
		<result  column="space_common_id" property="spaceCommonId" jdbcType="INTEGER" />
		<result  column="config_file_id" property="configFileId" jdbcType="INTEGER" />
		<result  column="evening_file_id" property="eveningFileId" jdbcType="INTEGER" />
		<result  column="dawn_file_id" property="dawnFileId" jdbcType="INTEGER" />
		<result  column="night_file_id" property="nightFileId" jdbcType="INTEGER" />
		<result  column="model_id" property="modelId" jdbcType="INTEGER" />
		<result  column="model_3d_id" property="model3dId" jdbcType="INTEGER" />
		<result  column="web_model_u3d_id" property="webModelU3dId" jdbcType="INTEGER" />
		<result  column="ios_model_u3d_id" property="iosModelU3dId" jdbcType="INTEGER" />
		<result  column="ipad_model_u3d_id" property="ipadModelU3dId" jdbcType="INTEGER" />
		<result  column="pc_model_u3d_id" property="pcModelU3dId" jdbcType="INTEGER" />
		<result  column="android_model_u3d_id" property="androidModelU3dId" jdbcType="INTEGER" />
		<result  column="macBookpc_model_u3d_id" property="macBookpcModelU3dId" jdbcType="INTEGER" />
		<result  column="pic_id" property="picId" jdbcType="INTEGER" />
		<result  column="cad_pic_id" property="cadPicId" jdbcType="INTEGER" />
		<result  column="putaway_state" property="putawayState" jdbcType="INTEGER" />
		<result  column="render_pic_ids" property="renderPicIds" jdbcType="VARCHAR" />
		<result  column="is_recommend" property="isRecommend" jdbcType="INTEGER" />
		<result  column="sys_code" property="sysCode" jdbcType="VARCHAR" />
		<result  column="creator" property="creator" jdbcType="VARCHAR" />
		<result  column="gmt_create" property="gmtCreate" jdbcType="TIMESTAMP" />
		<result  column="modifier" property="modifier" jdbcType="VARCHAR" />
		<result  column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP" />
		<result  column="is_deleted" property="isDeleted" jdbcType="INTEGER" />
		<result  column="remark" property="remark" jdbcType="VARCHAR" />
		<result  column="fbx_file_id" property="fbxFileId" jdbcType="INTEGER"/>
		<result  column="fbx_texture" property="fbxTexture" jdbcType="VARCHAR"/>
		<result  column="fbx_state" property="fbxState" jdbcType="INTEGER"/>
		<result  column="effect_pic" property="effectPic" jdbcType="VARCHAR" />
		<result  column="effect_plan_ids" property="effectPlanIds" jdbcType="VARCHAR" />
 
 
		<result column="space_common_code" property="spaceCommonCode" jdbcType="VARCHAR" />
		<result column="model_u3d_id" property="modelU3dId" jdbcType="VARCHAR" />
		<result column="model_u3d_id" property="modelU3dId" jdbcType="VARCHAR" />
		<result column="macBookPc_u3d_model_id" property="macBookPcU3dModelId" jdbcType="VARCHAR" />
		<result column="windowsPc_u3d_model_id" property="windowsPcU3dModelId" jdbcType="VARCHAR" />
		<result column="ipad_u3d_model_id" property="ipadU3dModelId" jdbcType="VARCHAR" />
		<result column="android_u3d_model_id" property="androidU3dModelId" jdbcType="VARCHAR" />
		<result column="ios_u3d_model_id" property="iosU3dModelId" jdbcType="VARCHAR" />
		<result  column="smallpox_identify_str" property="smallpoxIdentify" jdbcType="VARCHAR"/>
		<result  column="ground_identify_str" property="groundIdentify" jdbcType="VARCHAR"/>
		<result  column="unique_id" property="uniqueId" jdbcType="VARCHAR"/>
	</resultMap>
	
	<!-- **查询定义** -->
	<!-- 按主键查询 -->
	<select id="selectByPrimaryKey" resultMap="AllResultMap"
		parameterType="java.lang.Integer">
		select
		<include refid="All_Column_List" />
		from design_templet
		where id = #{id,jdbcType=INTEGER}
	</select>
	<!-- 按编码查询 -->
	<select id="selectByTemplateCode" resultMap="AllResultMap"
		parameterType="java.lang.String">
		select
		<include refid="All_Column_List" />
		from design_templet
		where design_code = #{designCode,jdbcType=VARCHAR}
	</select>
	
		<!-- **查询定义** -->
	<!-- 按主键查询 -->
	<select id="selectByPrimaryKeyV2" resultMap="AllResultMap"
		parameterType="java.lang.Integer">
		select
		dt.id,
		dt.design_code,dt.design_name,dt.user_id,dt.design_source_type,dt.design_style_id,dt.space_common_id,dt.config_file_id,dt.model_id,dt.model_3d_id,dt.web_model_u3d_id,dt.ios_model_u3d_id,dt.ipad_model_u3d_id,
		dt.pc_model_u3d_id,dt.android_model_u3d_id,dt.macBookpc_model_u3d_id,dt.pic_id,dt.cad_pic_id,dt.putaway_state,dt.render_pic_ids,dt.is_recommend,dt.sys_code,dt.creator,dt.gmt_create,
		dt.modifier,dt.gmt_modified,dt.is_deleted,dt.remark,dt.effect_pic,dt.effect_plan_ids,
		dt.evening_file_id,dt.dawn_file_id,dt.night_file_id,dt.fbx_file_id,dt.fbx_texture,dt.fbx_state, sc.space_code as 'space_common_code',  
		sc.windowsPc_u3d_model_id  ,
		sc.macBookPc_u3d_model_id   ,
		sc.ios_u3d_model_id,
		sc.android_u3d_model_id,
		sc.ipad_u3d_model_id,
		sc.model_u3d_id
		from design_templet as dt  LEFT JOIN space_common  as sc on(dt.space_common_id = sc.id)
		where dt.id =#{id,jdbcType=INTEGER}
	</select>
	
	<select id="geTempletsBySpaceInfo" resultMap="AllResultMap">
		select
		dt.id,
		dt.design_code,dt.design_name,dt.user_id,dt.design_source_type,dt.design_style_id,dt.space_common_id,dt.config_file_id,dt.model_id,dt.model_3d_id,dt.web_model_u3d_id,dt.ios_model_u3d_id,dt.ipad_model_u3d_id,
		dt.pc_model_u3d_id,dt.android_model_u3d_id,dt.macBookpc_model_u3d_id,dt.pic_id,dt.cad_pic_id,dt.putaway_state,dt.render_pic_ids,dt.is_recommend,dt.sys_code,dt.creator,dt.gmt_create,
		dt.modifier,dt.gmt_modified,dt.is_deleted,dt.remark,dt.effect_pic,dt.effect_plan_ids,
		dt.evening_file_id,dt.dawn_file_id,dt.night_file_id,dt.fbx_file_id,dt.fbx_texture,dt.fbx_state, sc.space_code as 'space_common_code',
		sc.windowsPc_u3d_model_id  ,
		sc.macBookPc_u3d_model_id   ,
		sc.ios_u3d_model_id,
		sc.android_u3d_model_id,
		sc.ipad_u3d_model_id,
		sc.model_u3d_id
		from design_templet as dt  LEFT JOIN space_common  as sc on(dt.space_common_id = sc.id)
		where sc.space_areas = #{spaceAreas,jdbcType=VARCHAR}
		and sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
		<if test="createdOfTemplateId!= null">  and dt.id <![CDATA[ <> ]]> #{createdOfTemplateId,jdbcType=INTEGER} </if>
		and dt.putaway_state = 3
		and dt.is_deleted = 0
	</select>

	<select id="getTempletsBySpaceAreasInfo" resultMap="AllResultMap">
		select
		dt.id,
		dt.design_code,dt.design_name,dt.user_id,dt.design_source_type,dt.design_style_id,dt.space_common_id,dt.config_file_id,dt.model_id,dt.model_3d_id,dt.web_model_u3d_id,dt.ios_model_u3d_id,dt.ipad_model_u3d_id,
		dt.pc_model_u3d_id,dt.android_model_u3d_id,dt.macBookpc_model_u3d_id,dt.pic_id,dt.cad_pic_id,dt.putaway_state,dt.render_pic_ids,dt.is_recommend,dt.sys_code,dt.creator,dt.gmt_create,
		dt.modifier,dt.gmt_modified,dt.is_deleted,dt.remark,dt.effect_pic,dt.effect_plan_ids,
		dt.evening_file_id,dt.dawn_file_id,dt.night_file_id,dt.fbx_file_id,dt.fbx_texture,dt.fbx_state, sc.space_code as 'space_common_code',
		sc.windowsPc_u3d_model_id  ,
		sc.macBookPc_u3d_model_id   ,
		sc.ios_u3d_model_id,
		sc.android_u3d_model_id,
		sc.ipad_u3d_model_id,
		sc.model_u3d_id
		from design_templet as dt  LEFT JOIN space_common  as sc on(dt.space_common_id = sc.id)
		where 1=1
		<if test="spaceAreas!= null and spaceAreas!='' ">
			and FIND_IN_SET(sc.space_areas,#{spaceAreas,jdbcType=VARCHAR})
		</if>
		and sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
		<if test="createdOfTemplateId!= null">  and dt.id <![CDATA[ <> ]]> #{createdOfTemplateId,jdbcType=INTEGER} </if>
		and dt.putaway_state = 3
		and dt.is_deleted = 0
	</select>

	<!-- 查询所有，可排序 -->
    <select id="selectList" resultMap="AllResultMap"
		parameterType="com.nork.design.model.DesignTemplet">
		select
		<include refid="All_Column_List" />
		from design_templet
        where 1=1
		<if test="designCode!= null">  and design_code = #{designCode,jdbcType=VARCHAR} </if>
		<if test="designName!= null">  and design_name = #{designName,jdbcType=VARCHAR} </if>
		<if test="userId!= null">  and user_id = #{userId,jdbcType=INTEGER} </if>
		<if test="designSourceType!= null">  and design_source_type = #{designSourceType,jdbcType=VARCHAR} </if>
		<if test="designStyleId!= null">  and design_style_id = #{designStyleId,jdbcType=INTEGER} </if>
		<if test="spaceCommonId!= null">  and space_common_id = #{spaceCommonId,jdbcType=INTEGER} </if>
		<if test="configFileId!= null">  and config_file_id = #{configFileId,jdbcType=INTEGER} </if>
		<if test="modelId!= null">  and model_id = #{modelId,jdbcType=INTEGER} </if>
		<if test="model3dId!= null">  and model_3d_id = #{model3dId,jdbcType=INTEGER} </if>
		<if test="webModelU3dId!= null">  and web_model_u3d_id = #{webModelU3dId,jdbcType=INTEGER} </if>
		<if test="iosModelU3dId!= null">  and ios_model_u3d_id = #{iosModelU3dId,jdbcType=INTEGER} </if>
		<if test="ipadModelU3dId!= null">  and ipad_model_u3d_id = #{ipadModelU3dId,jdbcType=INTEGER} </if>
		<if test="pcModelU3dId!= null">  and pc_model_u3d_id = #{pcModelU3dId,jdbcType=INTEGER} </if>
		<if test="androidModelU3dId!= null">  and android_model_u3d_id = #{androidModelU3dId,jdbcType=INTEGER} </if>
		<if test="macBookpcModelU3dId!= null">  and macBookpc_model_u3d_id = #{macBookpcModelU3dId,jdbcType=INTEGER} </if>
		<if test="picId!= null">  and pic_id = #{picId,jdbcType=INTEGER} </if>
		<if test="cadPicId!= null">  and cad_pic_id = #{cadPicId,jdbcType=INTEGER} </if>
		<if test="putawayState!= null">  and putaway_state = #{putawayState,jdbcType=INTEGER} </if>
		<if test="renderPicIds!= null">  and render_pic_ids = #{renderPicIds,jdbcType=VARCHAR} </if>
		<if test="effectPic!= null and effectPic != ''">
			and POSITION(CONCAT(CONCAT(',',#{effectPic}),',') IN CONCAT(CONCAT(',',effect_pic),',')) >0
		</if>
		<if test="effectPlanIds!= null and effectPlanIds != ''">
			and POSITION(CONCAT(CONCAT(',',#{effectPlanIds}),',') IN CONCAT(CONCAT(',',effect_plan_ids),',')) >0
		</if>
		<if test="isRecommend!= null">  and is_recommend = #{isRecommend,jdbcType=INTEGER} </if>
		<if test="sysCode!= null">  and sys_code = #{sysCode,jdbcType=VARCHAR} </if>
		<if test="creator!= null">  and creator = #{creator,jdbcType=VARCHAR} </if>
		<if test="gmtCreate!= null">  and gmt_create = #{gmtCreate,jdbcType=TIMESTAMP} </if>
		<if test="modifier!= null">  and modifier = #{modifier,jdbcType=VARCHAR} </if>
		<if test="gmtModified!= null">  and gmt_modified = #{gmtModified,jdbcType=TIMESTAMP} </if>
		<if test="isDeleted!= null">  and is_deleted = #{isDeleted,jdbcType=INTEGER} </if>
		<if test="remark!= null">  and remark = #{remark,jdbcType=VARCHAR} </if>
		<if test="order != null and  order !=''  ">
			order by ${order}
			<if test="orderNum != null and  orderNum !='' ">
				${orderNum}
			</if>
		</if>
		<if test="orders != null and  orders !=''  ">
		   order by ${orders}
		</if>
	</select>
	
	<!-- 分页汇总 -->
	<select id="selectCount" resultType="int"
		parameterType="com.nork.design.model.search.DesignTempletSearch">
		select count(*)
		<if test="levelLimitCount >= 0"> from (select * from design_templet limit #{levelLimitCount} ) dt </if>
		<if test="levelLimitCount &lt; 0">from design_templet dt</if>
		
		<if test="spaceFunctionId !=  null and spaceFunctionId !=  ''   ">
	   		 JOIN space_common sc ON sc.id = dt.space_common_id
	    </if>
		where 1=1	
		<if test="spaceFunctionId !=  null and spaceFunctionId !=  ''   ">
			 and sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
		</if>
		<if test="spaceAreas !=  null and spaceAreas !=  ''   ">
			 and sc.space_areas = #{spaceAreas,jdbcType=VARCHAR}
		</if>
		<if test="id !=  null and id !=  ''   "> and dt.id  = #{id,jdbcType=INTEGER} </if>
		<if test="designCode !=  null and designCode !=  ''   "> and design_code  = #{designCode,jdbcType=VARCHAR} </if>
		<if test="sch_DesignCode_ !=  null and sch_DesignCode_ !=  ''   ">
			and design_code  like CONCAT(CONCAT('%',#{sch_DesignCode_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_DesignCode !=  null and sch_DesignCode !=  ''   ">
			and design_code  like CONCAT('%',#{sch_DesignCode,jdbcType=VARCHAR})
		 </if>
		<if test="schDesignCode_ !=  null and schDesignCode_ !=  ''   ">
			and design_code  like CONCAT(#{schDesignCode_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="designCodeStart !=  null and designCodeEnd!= null  ">
			and design_code between #{designCodeStart,jdbcType=VARCHAR} and #{designCodeEnd,jdbcType=VARCHAR}
		 </if>
		<if test="designName !=  null and designName !=  ''   "> and design_name  = #{designName,jdbcType=VARCHAR} </if>
		<if test="sch_DesignName_ !=  null and sch_DesignName_ !=  ''   ">
			and design_name  like CONCAT(CONCAT('%',#{sch_DesignName_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_DesignName !=  null and sch_DesignName !=  ''   ">
			and design_name  like CONCAT('%',#{sch_DesignName,jdbcType=VARCHAR})
		 </if>
		<if test="schDesignName_ !=  null and schDesignName_ !=  ''   ">
			and design_name  like CONCAT(#{schDesignName_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="designNameStart !=  null and designNameEnd!= null  ">
			and design_name between #{designNameStart,jdbcType=VARCHAR} and #{designNameEnd,jdbcType=VARCHAR}
		 </if>
		<if test="userId !=  null  ">			and user_id  = #{userId,jdbcType=INTEGER} </if>
		<if test="designSourceType !=  null and designSourceType !=  ''   "> and design_source_type  = #{designSourceType,jdbcType=VARCHAR} </if>
		<if test="sch_DesignSourceType_ !=  null and sch_DesignSourceType_ !=  ''   ">
			and design_source_type  like CONCAT(CONCAT('%',#{sch_DesignSourceType_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_DesignSourceType !=  null and sch_DesignSourceType !=  ''   ">
			and design_source_type  like CONCAT('%',#{sch_DesignSourceType,jdbcType=VARCHAR})
		 </if>
		<if test="schDesignSourceType_ !=  null and schDesignSourceType_ !=  ''   ">
			and design_source_type  like CONCAT(#{schDesignSourceType_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="designSourceTypeStart !=  null and designSourceTypeEnd!= null  ">
			and design_source_type between #{designSourceTypeStart,jdbcType=VARCHAR} and #{designSourceTypeEnd,jdbcType=VARCHAR}
		 </if>
		<if test="designStyleId !=  null  ">			and design_style_id  = #{designStyleId,jdbcType=INTEGER} </if>
		<if test="spaceCommonId !=  null  ">    and space_common_id  = #{spaceCommonId,jdbcType=INTEGER} </if>
		<if test="configFileId !=  null and configFileId !=  ''   "> and config_file_id  = #{configFileId,jdbcType=INTEGER} </if>
		<if test="modelId !=  null "> and model_id  = #{modelId,jdbcType=INTEGER} </if>
		<if test="model3dId !=  null "> and model_3d_id  = #{model3dId,jdbcType=INTEGER} </if>
		<if test="webModelU3dId!= null">  and web_model_u3d_id = #{webModelU3dId,jdbcType=INTEGER} </if>
		<if test="iosModelU3dId!= null">  and ios_model_u3d_id = #{iosModelU3dId,jdbcType=INTEGER} </if>
		<if test="ipadModelU3dId!= null">  and ipad_model_u3d_id = #{ipadModelU3dId,jdbcType=INTEGER} </if>
		<if test="pcModelU3dId!= null">  and pc_model_u3d_id = #{pcModelU3dId,jdbcType=INTEGER} </if>
		<if test="androidModelU3dId!= null">  and android_model_u3d_id = #{androidModelU3dId,jdbcType=INTEGER} </if>
		<if test="macBookpcModelU3dId!= null">  and macBookpc_model_u3d_id = #{macBookpcModelU3dId,jdbcType=INTEGER} </if>
		<if test="picId !=  null "> and pic_id  = #{picId,jdbcType=INTEGER} </if>
		<if test="cadPicId !=  null "> and cad_pic_id  = #{cadPicId,jdbcType=INTEGER} </if>
		
		<if test="putawayState !=  null "> and putaway_state  = #{putawayState,jdbcType=INTEGER} </if>
		
		<if test="putawayStates !=  null and  putawayStates.size > 0  ">
			and putaway_state in
			<foreach collection="putawayStates" index="index" item="item" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
		
		<if test="renderPicIds !=  null "> and render_pic_ids  = #{renderPicIds,jdbcType=VARCHAR} </if>
		<if test="isRecommend !=  null and isRecommend !=  ''   "> and is_recommend  = #{isRecommend,jdbcType=INTEGER} </if>
		<if test="sysCode !=  null and sysCode !=  ''   "> and sys_code  = #{sysCode,jdbcType=VARCHAR} </if>
		<if test="sch_SysCode_ !=  null and sch_SysCode_ !=  ''   ">
			and sys_code  like CONCAT(CONCAT('%',#{sch_SysCode_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_SysCode !=  null and sch_SysCode !=  ''   ">
			and sys_code  like CONCAT('%',#{sch_SysCode,jdbcType=VARCHAR})
		 </if>
		<if test="schSysCode_ !=  null and schSysCode_ !=  ''   ">
			and sys_code  like CONCAT(#{schSysCode_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="sysCodeStart !=  null and sysCodeEnd!= null  ">
			and sys_code between #{sysCodeStart,jdbcType=VARCHAR} and #{sysCodeEnd,jdbcType=VARCHAR}
		 </if>
		<if test="creator !=  null and creator !=  ''   "> and creator  = #{creator,jdbcType=VARCHAR} </if>
		<if test="sch_Creator_ !=  null and sch_Creator_ !=  ''   ">
			and creator  like CONCAT(CONCAT('%',#{sch_Creator_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_Creator !=  null and sch_Creator !=  ''   ">
			and creator  like CONCAT('%',#{sch_Creator,jdbcType=VARCHAR})
		 </if>
		<if test="schCreator_ !=  null and schCreator_ !=  ''   ">
			and creator  like CONCAT(#{schCreator_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="creatorStart !=  null and creatorEnd!= null  ">
			and creator between #{creatorStart,jdbcType=VARCHAR} and #{creatorEnd,jdbcType=VARCHAR}
		 </if>
		<if test="gmtCreate !=  null  ">
			and gmt_create  = #{gmtCreate,jdbcType=TIMESTAMP}
		 </if>
		<if test="gmtCreateStart !=  null and gmtCreateEnd!= null  ">
			and gmt_create between #{gmtCreateStart,jdbcType=TIMESTAMP} and #{gmtCreateEnd,jdbcType=TIMESTAMP}
		 </if>
		<if test="modifier !=  null and modifier !=  ''   "> and modifier  = #{modifier,jdbcType=VARCHAR} </if>
		<if test="sch_Modifier_ !=  null and sch_Modifier_ !=  ''   ">
			and modifier  like CONCAT(CONCAT('%',#{sch_Modifier_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_Modifier !=  null and sch_Modifier !=  ''   ">
			and modifier  like CONCAT('%',#{sch_Modifier,jdbcType=VARCHAR})
		 </if>
		<if test="schModifier_ !=  null and schModifier_ !=  ''   ">
			and modifier  like CONCAT(#{schModifier_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="modifierStart !=  null and modifierEnd!= null  ">
			and modifier between #{modifierStart,jdbcType=VARCHAR} and #{modifierEnd,jdbcType=VARCHAR}
		 </if>
		<if test="gmtModified !=  null  ">
			and gmt_modified  = #{gmtModified,jdbcType=TIMESTAMP}
		 </if>
		<if test="gmtModifiedStart !=  null and gmtModifiedEnd!= null  ">
			and gmt_modified between #{gmtModifiedStart,jdbcType=TIMESTAMP} and #{gmtModifiedEnd,jdbcType=TIMESTAMP}
		 </if>
		<if test="isDeleted !=  null  ">			and is_deleted  = #{isDeleted,jdbcType=INTEGER} </if>
		<if test="remark !=  null and remark !=  ''   "> and remark  = #{remark,jdbcType=VARCHAR} </if>		<if test="sch_Remark_ !=  null and sch_Remark_ !=  ''   ">
			and remark  like CONCAT(CONCAT('%',#{sch_Remark_,jdbcType=VARCHAR}),'%')
		 </if>		<if test="sch_Remark !=  null and sch_Remark !=  ''   ">
			and remark  like CONCAT('%',#{sch_Remark,jdbcType=VARCHAR})
		 </if>		<if test="schRemark_ !=  null and schRemark_ !=  ''   ">
			and remark  like CONCAT(#{schRemark_,jdbcType=VARCHAR},'%')
		 </if>		<if test="remarkStart !=  null and remarkEnd!= null  ">
			and remark between #{remarkStart,jdbcType=VARCHAR} and #{remarkEnd,jdbcType=VARCHAR}
		 </if>
		 <if test="spaceIdList !=  null and  spaceIdList.size > 0  ">
		  and space_common_id in
	        <foreach collection="spaceIdList" index="index" item="item" open="(" separator="," close=")">
	                 #{item}
	        </foreach>
        </if>
        <if test="isHasPic ==  1 ">
			and pic_id   &gt; 0
		</if>
		<if test="isHasPic ==  2 ">
			and pic_id  = 0
		</if>
	</select>
	
	<!-- 分页查询 ,可在DesignTempletSearch中自定义查询条件-->
	<select id="selectPaginatedList" resultMap="AllResultMap"
		parameterType="com.nork.design.model.search.DesignTempletSearch">
		select
		dt.id,dt.design_code,dt.design_name,dt.user_id,dt.design_source_type,dt.design_style_id,dt.space_common_id,dt.config_file_id,dt.model_id,
		dt.model_3d_id,dt.web_model_u3d_id,dt.ios_model_u3d_id,dt.ipad_model_u3d_id,dt.pc_model_u3d_id,dt.android_model_u3d_id,dt.macBookpc_model_u3d_id,
		dt.pic_id,dt.putaway_state,dt.render_pic_ids,dt.is_recommend,dt.sys_code,dt.creator,dt.gmt_create,dt.modifier,dt.gmt_modified,dt.is_deleted,
		dt.remark,dt.effect_pic,dt.effect_plan_ids,dt.evening_file_id,dt.dawn_file_id,dt.night_file_id
	   
	    <if test="levelLimitCount>=0">
	     from (select *  from design_templet limit #{levelLimitCount}  ) dt
	    </if>
	    <if test="levelLimitCount &lt; 0">
	     from design_templet dt
	     </if>
	    <if test="spaceFunctionId !=  null and spaceFunctionId !=  ''   ">
	   		 JOIN space_common sc ON sc.id = dt.space_common_id
	    </if>
		where 1=1	
		<if test="spaceFunctionId !=  null and spaceFunctionId !=  ''   ">
			 and sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
		</if>
		<if test="spaceAreas !=  null and spaceAreas !=  ''   ">
			 and sc.space_areas = #{spaceAreas,jdbcType=VARCHAR}
		</if>
		<if test="id !=  null and id !=  ''   "> and dt.id  = #{id,jdbcType=INTEGER} </if>
		
		<if test="designCode !=  null and designCode !=  ''   "> and design_code  = #{designCode,jdbcType=VARCHAR} </if>
		<if test="sch_DesignCode_ !=  null and sch_DesignCode_ !=  ''   ">
			and design_code  like CONCAT(CONCAT('%',#{sch_DesignCode_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_DesignCode !=  null and sch_DesignCode !=  ''   ">
			and design_code  like CONCAT('%',#{sch_DesignCode,jdbcType=VARCHAR})
		 </if>
		<if test="schDesignCode_ !=  null and schDesignCode_ !=  ''   ">
			and design_code  like CONCAT(#{schDesignCode_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="designCodeStart !=  null and designCodeEnd!= null  ">
			and design_code between #{designCodeStart,jdbcType=VARCHAR} and #{designCodeEnd,jdbcType=VARCHAR}
		 </if>
		<if test="designName !=  null and designName !=  ''   "> and design_name  = #{designName,jdbcType=VARCHAR} </if>
		<if test="sch_DesignName_ !=  null and sch_DesignName_ !=  ''   ">
			and design_name  like CONCAT(CONCAT('%',#{sch_DesignName_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_DesignName !=  null and sch_DesignName !=  ''   ">
			and design_name  like CONCAT('%',#{sch_DesignName,jdbcType=VARCHAR})
		 </if>
		<if test="schDesignName_ !=  null and schDesignName_ !=  ''   ">
			and design_name  like CONCAT(#{schDesignName_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="designNameStart !=  null and designNameEnd!= null  ">
			and design_name between #{designNameStart,jdbcType=VARCHAR} and #{designNameEnd,jdbcType=VARCHAR}
		 </if>
		<if test="userId !=  null  ">			and user_id  = #{userId,jdbcType=INTEGER} </if>
		<if test="designSourceType !=  null and designSourceType !=  ''   "> and design_source_type  = #{designSourceType,jdbcType=VARCHAR} </if>
		<if test="sch_DesignSourceType_ !=  null and sch_DesignSourceType_ !=  ''   ">
			and design_source_type  like CONCAT(CONCAT('%',#{sch_DesignSourceType_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_DesignSourceType !=  null and sch_DesignSourceType !=  ''   ">
			and design_source_type  like CONCAT('%',#{sch_DesignSourceType,jdbcType=VARCHAR})
		 </if>
		<if test="schDesignSourceType_ !=  null and schDesignSourceType_ !=  ''   ">
			and design_source_type  like CONCAT(#{schDesignSourceType_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="designSourceTypeStart !=  null and designSourceTypeEnd!= null  ">
			and design_source_type between #{designSourceTypeStart,jdbcType=VARCHAR} and #{designSourceTypeEnd,jdbcType=VARCHAR}
		 </if>
		<if test="designStyleId !=  null  ">			and design_style_id  = #{designStyleId,jdbcType=INTEGER} </if>
		<if test="spaceCommonId !=  null  ">			and space_common_id  = #{spaceCommonId,jdbcType=INTEGER} </if>
		<if test="configFileId !=  null and configFileId !=  ''   "> and config_file_id  = #{configFileId,jdbcType=INTEGER} </if>
		<if test="modelId !=  null "> and model_id  = #{modelId,jdbcType=INTEGER} </if>
		<if test="model3dId !=  null "> and model_3d_id  = #{model3dId,jdbcType=INTEGER} </if>
		<if test="webModelU3dId!= null">  and web_model_u3d_id = #{webModelU3dId,jdbcType=INTEGER} </if>
		<if test="iosModelU3dId!= null">  and ios_model_u3d_id = #{iosModelU3dId,jdbcType=INTEGER} </if>
		<if test="ipadModelU3dId!= null">  and ipad_model_u3d_id = #{ipadModelU3dId,jdbcType=INTEGER} </if>
		<if test="pcModelU3dId!= null">  and pc_model_u3d_id = #{pcModelU3dId,jdbcType=INTEGER} </if>
		<if test="androidModelU3dId!= null">  and android_model_u3d_id = #{androidModelU3dId,jdbcType=INTEGER} </if>
		<if test="macBookpcModelU3dId!= null">  and macBookpc_model_u3d_id = #{macBookpcModelU3dId,jdbcType=INTEGER} </if>
		<if test="picId !=  null "> and pic_id  = #{picId,jdbcType=INTEGER} </if>
		<if test="cadPicId !=  null "> and cad_pic_id  = #{cadPicId,jdbcType=INTEGER} </if>
		<if test="putawayState !=  null "> and putaway_state  = #{putawayState,jdbcType=INTEGER} </if>
				
		<if test="putawayStates !=  null and  putawayStates.size > 0  ">
			and putaway_state in
			<foreach collection="putawayStates" index="index" item="item" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
		
		<if test="renderPicIds !=  null "> and render_pic_ids  = #{renderPicIds,jdbcType=VARCHAR} </if>
		<if test="isRecommend !=  null and isRecommend !=  ''   "> and is_recommend  = #{isRecommend,jdbcType=INTEGER} </if>
		<if test="sysCode !=  null and sysCode !=  ''   "> and sys_code  = #{sysCode,jdbcType=VARCHAR} </if>
		<if test="sch_SysCode_ !=  null and sch_SysCode_ !=  ''   ">
			and sys_code  like CONCAT(CONCAT('%',#{sch_SysCode_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_SysCode !=  null and sch_SysCode !=  ''   ">
			and sys_code  like CONCAT('%',#{sch_SysCode,jdbcType=VARCHAR})
		 </if>
		<if test="schSysCode_ !=  null and schSysCode_ !=  ''   ">
			and sys_code  like CONCAT(#{schSysCode_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="sysCodeStart !=  null and sysCodeEnd!= null  ">
			and sys_code between #{sysCodeStart,jdbcType=VARCHAR} and #{sysCodeEnd,jdbcType=VARCHAR}
		 </if>
		<if test="creator !=  null and creator !=  ''   "> and creator  = #{creator,jdbcType=VARCHAR} </if>
		<if test="sch_Creator_ !=  null and sch_Creator_ !=  ''   ">
			and creator  like CONCAT(CONCAT('%',#{sch_Creator_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_Creator !=  null and sch_Creator !=  ''   ">
			and creator  like CONCAT('%',#{sch_Creator,jdbcType=VARCHAR})
		 </if>
		<if test="schCreator_ !=  null and schCreator_ !=  ''   ">
			and creator  like CONCAT(#{schCreator_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="creatorStart !=  null and creatorEnd!= null  ">
			and creator between #{creatorStart,jdbcType=VARCHAR} and #{creatorEnd,jdbcType=VARCHAR}
		 </if>
		<if test="gmtCreate !=  null  ">
			and gmt_create  = #{gmtCreate,jdbcType=TIMESTAMP}
		 </if>
		<if test="gmtCreateStart !=  null and gmtCreateEnd!= null  ">
			and gmt_create between #{gmtCreateStart,jdbcType=TIMESTAMP} and #{gmtCreateEnd,jdbcType=TIMESTAMP}
		 </if>
		<if test="modifier !=  null and modifier !=  ''   "> and modifier  = #{modifier,jdbcType=VARCHAR} </if>
		<if test="sch_Modifier_ !=  null and sch_Modifier_ !=  ''   ">
			and modifier  like CONCAT(CONCAT('%',#{sch_Modifier_,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="sch_Modifier !=  null and sch_Modifier !=  ''   ">
			and modifier  like CONCAT('%',#{sch_Modifier,jdbcType=VARCHAR})
		 </if>
		<if test="schModifier_ !=  null and schModifier_ !=  ''   ">
			and modifier  like CONCAT(#{schModifier_,jdbcType=VARCHAR},'%')
		 </if>
		<if test="modifierStart !=  null and modifierEnd!= null  ">
			and modifier between #{modifierStart,jdbcType=VARCHAR} and #{modifierEnd,jdbcType=VARCHAR}
		 </if>
		<if test="gmtModified !=  null  ">
			and gmt_modified  = #{gmtModified,jdbcType=TIMESTAMP}
		 </if>
		<if test="gmtModifiedStart !=  null and gmtModifiedEnd!= null  ">
			and gmt_modified between #{gmtModifiedStart,jdbcType=TIMESTAMP} and #{gmtModifiedEnd,jdbcType=TIMESTAMP}
		 </if>
		<if test="isDeleted !=  null  ">			and is_deleted  = #{isDeleted,jdbcType=INTEGER} </if>
		<if test="remark !=  null and remark !=  ''   "> and remark  = #{remark,jdbcType=VARCHAR} </if>		<if test="sch_Remark_ !=  null and sch_Remark_ !=  ''   ">
			and remark  like CONCAT(CONCAT('%',#{sch_Remark_,jdbcType=VARCHAR}),'%')
		 </if>		<if test="sch_Remark !=  null and sch_Remark !=  ''   ">
			and remark  like CONCAT('%',#{sch_Remark,jdbcType=VARCHAR})
		 </if>		<if test="schRemark_ !=  null and schRemark_ !=  ''   ">
			and remark  like CONCAT(#{schRemark_,jdbcType=VARCHAR},'%')
		 </if>		<if test="remarkStart !=  null and remarkEnd!= null  ">
			and remark between #{remarkStart,jdbcType=VARCHAR} and #{remarkEnd,jdbcType=VARCHAR}
		 </if>
		 <if test="spaceIdList !=  null and  spaceIdList.size > 0  ">
		  and space_common_id in
	        <foreach collection="spaceIdList" index="index" item="item" open="(" separator="," close=")">
	                 #{item}
	        </foreach>
        </if>
        <if test="isHasPic ==  1 ">
			and pic_id   &gt; 0
		</if>
		<if test="isHasPic ==  2 ">
			and pic_id  = 0
		</if>
		 
		<if test="order != null and  order !=''  ">
			order by ${order} <if test="orderNum != null and  orderNum !='' ">${orderNum}</if>
		</if>
		<if test="orders != null and  orders !=''  ">  order by ${orders}</if>
		<if test="order == null and  orders == null "> order by (CASE RIGHT(dt.design_code,3) WHEN '000' THEN  '9999' ELSE  RIGHT(dt.design_code,3) END) asc</if>
		<if test="start !=-1 and limit !=-1"> LIMIT #{start}, #{limit}</if>
	</select>
	<!-- **结果定义** -->
	<resultMap id="designSpaceResultMap" type="com.nork.design.model.DesignSpaceResult">
		<id column="id" property="templetId" jdbcType="INTEGER" />
		<result  column="design_name" property="designName" jdbcType="VARCHAR" />
		<result  column="design_code" property="designCode" jdbcType="VARCHAR" />
		<result  column="design_desc" property="designDesc" jdbcType="VARCHAR" />
		<result  column="pic_path" property="picPath" jdbcType="VARCHAR" />
		<result  column="space_name" property="spaceName" jdbcType="VARCHAR" />
		<result  column="space_areas" property="spaceAreas" jdbcType="VARCHAR" />
		<result  column="space_desc" property="spaceDesc" jdbcType="VARCHAR" />
		<result  column="effect_pic" property="renderPicIds" jdbcType="VARCHAR" />
	</resultMap>
	<!-- 前台样板间查询所有 -->
    <select id="spaceList" resultMap="designSpaceResultMap"
		parameterType="com.nork.design.model.DesignTemplet">
		SELECT dt.id,dt.design_code,dt.design_name,sc.space_name,sc.space_areas,sc.space_desc
		,dt.remark as design_desc
		,rp.pic_path,dt.effect_pic as renderPicIds  FROM design_templet dt 
 		LEFT JOIN res_pic rp on dt.pic_id=rp.id 
		LEFT JOIN space_common sc ON dt.space_common_id=sc.id 
		where 1=1 
		<if test="houseTypeValue!= null and houseTypeValue!=0 ">  and sc.space_function_id = #{houseTypeValue,jdbcType=INTEGER} </if>
		<if test="designStyleId!= null and designStyleId!=0 ">  and dt.design_style_id = #{designStyleId,jdbcType=INTEGER} </if> 
		<if test="order != null and  order !=''  ">
			order by dt.${order}
		</if>
	</select>
	<!-- 前台样板间渲染图片 -->
    <select id="spaceRender" resultMap="designSpaceResultMap"
		parameterType="java.lang.Integer">
		SELECT dt.id,dt.design_name,dt.design_code,dt.effect_pic,sc.space_name,sc.space_areas,sc.space_desc FROM design_templet dt
 		LEFT JOIN space_common sc ON dt.space_common_id=sc.id 
 		where dt.id=#{templetId}
	</select>
	
	<!-- 设计详情Result -->
	<resultMap id="designTempletResultMap" type="com.nork.design.model.DesignTempletResult">
		<id column="id" property="designId" jdbcType="INTEGER"/>
		<result column="user_id" property="userId" jdbcType="INTEGER"/>
		<result column="design_code" property="designCode" jdbcType="VARCHAR"/>
		<result column="design_name" property="designName" jdbcType="VARCHAR"/>
		<result column="user_name" property="userName" jdbcType="VARCHAR"/>
		<result column="space_code" property="spaceCode" jdbcType="VARCHAR"/>
		<result column="space_name" property="spaceName" jdbcType="VARCHAR"/>
		<result column="space_areas" property="spaceAreas" jdbcType="VARCHAR"/>
		<result column="effect_pic" property="renderPicIds" jdbcType="VARCHAR"/>
		<result column="gmt_create" property="gmtCreate" jdbcType="TIMESTAMP"/>
		<result column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP"/>
		<result column="pic_path" property="picPath" jdbcType="VARCHAR"/> 
	</resultMap>
    <!-- 设计详情查询 -->
	<select id="designList" resultMap="designTempletResultMap" parameterType="java.lang.Integer">
		SELECT dt.id,dt.design_code,dt.design_name,dt.user_id,dt.effect_pic,dt.gmt_create,dt.gmt_modified,
		sc.space_code,sc.space_name,sc.space_areas,su.user_name,rp.pic_path 
		FROM design_templet dt 
		LEFT JOIN space_common sc ON dt.space_common_id=sc.id 
		LEFT JOIN sys_user su ON dt.user_id=su.id 
		LEFT JOIN res_pic rp ON dt.pic_id=rp.id   
		WHERE dt.id = #{designId} 
	</select>

	<!-- 根据样板房ID删除关联的产品 -->
	<delete id="deleteByDesignId" parameterType="java.lang.Integer">
		delete from design_templet
		where design_templet_id = #{designTempletId,jdbcType=INTEGER}
	</delete>
	
			<!-- findAllName -->
	<select id="findAllName" resultType="java.lang.String">
		select 
		d.design_name 
		from design_templet d
	</select>
	
	<select id="findAllCode" resultType="int" parameterType="com.nork.design.model.search.DesignTempletSearch">
		SELECT	COUNT(*) FROM design_templet where 1=1
		<if test="schDesignCode_ !=  null and schDesignCode_ !=  ''   ">
			and design_code  like CONCAT(#{schDesignCode_,jdbcType=VARCHAR},'%')
		 </if>
	</select>
	
	
	<select id="selectVacantRoomList" resultMap="AllResultMap"
		parameterType="com.nork.design.model.search.DesignTempletSearch">
		select
		<include refid="All_Column_List" />
		from design_templet
        where 1=1
		<if test="sch_DesignCode!= null">  and design_code like CONCAT('%',#{sch_DesignCode,jdbcType=VARCHAR}) </if>
		<if test="orders != null and  orders !=''  ">
		   order by ${orders}
		</if>
	</select>
	<!-- getCodeByProductIdFromProductRecommendation -->
	<!-- 根据产品id查找推荐该产品的已上架样板房的code -->
	<select id="getCodeByProductIdFromProductRecommendation" resultType="java.lang.String" parameterType="java.lang.Integer">
		select dt.design_code from design_templet dt where dt.id in 
		(select distinct pr.design_templet_id from product_recommendation pr where pr.product_id = #{id,jdbcType=INTEGER} and pr.is_deleted = 0) 
		and dt.is_deleted = 0 and 
<!-- 		dt.putaway_state = 1 以前已经上架显示，现在是已发布的-->
			dt.putaway_state = 3
	</select>
	
	<!-- getTempletCodeBySpaceId -->
	<select id="getTempletCodeBySpaceId" resultType="java.lang.String" parameterType="java.lang.Integer">
		select dt.design_code from design_templet dt where dt.space_common_id = #{spaceCommonId,jdbcType=INTEGER} and 
<!-- 		dt.putaway_state = 1   以前已经上架显示，现在是已发布的显示-->
		dt.putaway_state = 3
		;
	</select>
	
	<!-- getTempletIdsBySpaceIds -->
	<select id="getTempletIdsBySpaceIds" resultType="java.lang.Integer">
		select dt.id from design_templet dt where 1=1 and dt.space_common_id in
		<foreach collection="spaceIds" index="index" item="item" open="(" separator="," close=")">
			#{item}
		</foreach>
		<choose>
			<when test="putawayStates !=  null and  putawayStates.size > 0  ">
				and putaway_state in
				<foreach collection="putawayStates" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
			</when>
			<otherwise>
<!-- 				and putaway_state=1  以前已经上架显示，现在是已发布的显示-->
				and putaway_state = 3
			</otherwise>
		</choose>
	</select>
	
		<select id="getDesignTempletByProduct" resultMap="AllResultMap" parameterType="java.util.Map">
			SELECT dt.* FROM design_templet AS dt 
			LEFT JOIN (SELECT DISTINCT dtp1.product_id,dtp1.design_templet_id FROM design_templet_product dtp1) 
			AS dtp ON(dt.id=dtp.design_templet_id) 
	        WHERE 1 = 1 
		<if test="productId != null and productId !=  '' ">  and dtp.product_id=#{productId,jdbcType=INTEGER} </if>
		<if test="designCode!= null and designCode !=  '' ">
		 and dt.design_code  like CONCAT(CONCAT('%',#{designCode,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="designName!= null and designName !=  '' "> 
		 and dt.design_name  like CONCAT(CONCAT('%',#{designName,jdbcType=VARCHAR}),'%')
		</if>
		<if test="start!= null and limit!=null">  limit  #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER} </if>
	</select>

		<select id="getDesignTempletByProductCount" resultType="java.lang.Integer" parameterType="java.util.Map">
		SELECT count(*) FROM design_templet AS dt 
		LEFT JOIN (SELECT DISTINCT dtp1.product_id,dtp1.design_templet_id FROM design_templet_product dtp1) 
		AS dtp ON(dt.id=dtp.design_templet_id) WHERE 1 = 1
		<if test="productId != null and productId !=  '' ">  and dtp.product_id=#{productId,jdbcType=INTEGER} </if>
		<if test="designCode!= null and designCode !=  '' ">
		 and dt.design_code  like CONCAT(CONCAT('%',#{designCode,jdbcType=VARCHAR}),'%')
		 </if>
		<if test="designName!= null and designName !=  '' "> 
		 and dt.design_name  like CONCAT(CONCAT('%',#{designName,jdbcType=VARCHAR}),'%')
		</if>
	</select>
	
	<!-- findIdListByStatus -->
	<select id="findIdListByStatus" resultType="java.lang.Integer">
		select id from design_templet where putaway_state = #{status,jdbcType=INTEGER};
	</select>
	
	<!-- updateStatus -->
	<update id="updateStatus">
		update design_templet set putaway_state = #{newStatus,jdbcType=INTEGER}
		where putaway_state = #{oldStatus,jdbcType=INTEGER};
	</update>

	<!-- 查询户型下所有样板房 -->
	<select id="selectTempletListByHouseId" parameterType="java.lang.Integer" resultMap="AllResultMap">
		   SELECT dt.*
        FROM design_templet dt
        INNER JOIN space_common sc ON dt.space_common_id = sc.id
        INNER JOIN house_space_new hsn ON hsn.standard_space_id = sc.id
        INNER JOIN base_house h ON hsn.house_id = h.id
        WHERE 1=1
         AND h.id = #{houseId,jdbcType=INTEGER}
         AND dt.is_deleted =0
         AND sc.is_deleted = 0
         AND hsn.is_deleted = 0
         AND h.is_deleted =0
	</select>
</mapper>
