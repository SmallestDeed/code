<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sandu.service.springFestivalActivity.dao.WxUserSigninMapper" >
  <resultMap id="BaseResultMap" type="com.sandu.api.springFestivalActivity.model.WxUserSignin" >
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="activity_id" property="activityId" jdbcType="BIGINT" />
    <result column="user_id" property="userId" jdbcType="BIGINT" />
    <result column="signin_date" property="signinDate" jdbcType="DATE" />
    <result column="signin_day" property="signinDay" jdbcType="INTEGER" />
    <result column="red_packet_num" property="redPacketNum" jdbcType="DECIMAL" />
    <result column="receive_status" property="receiveStatus" jdbcType="TINYINT" />
    <result column="receive_time" property="receiveTime" jdbcType="TIMESTAMP" />
    <result column="have_lottery_chance" property="haveLotteryChance" jdbcType="TINYINT" />
    <result column="is_lottery_flag" property="isLotteryFlag" jdbcType="TINYINT" />
    <result column="creator" property="creator" jdbcType="VARCHAR" />
    <result column="gmt_create" property="gmtCreate" jdbcType="TIMESTAMP" />
    <result column="modifier" property="modifier" jdbcType="VARCHAR" />
    <result column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP" />
    <result column="is_deleted" property="isDeleted" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, activity_id, user_id, signin_date, signin_day, red_packet_num, receive_status, receive_time,
    have_lottery_chance, is_lottery_flag, creator, gmt_create, modifier, gmt_modified, is_deleted
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    select 
    <include refid="Base_Column_List" />
    from wx_user_signin
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    delete from wx_user_signin
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.sandu.api.springFestivalActivity.model.WxUserSignin" >
    insert into wx_user_signin (id, activity_id, user_id, 
      signin_date, signin_day, red_packet_num, 
      receive_status, receive_time, have_lottery_chance
      is_lottery_flag, creator, gmt_create,
      modifier, gmt_modified, is_deleted)
    values (#{id,jdbcType=BIGINT}, #{activityId,jdbcType=BIGINT}, #{userId,jdbcType=BIGINT}, 
      #{signinDate,jdbcType=DATE}, #{signinDay,jdbcType=INTEGER}, #{redPacketNum,jdbcType=DECIMAL}, 
      #{receiveStatus,jdbcType=TINYINT}, #{receiveTime,jdbcType=TIMESTAMP}, #{haveLotteryChance,jdbcType=TINYINT},
      #{isLotteryFlag,jdbcType=TINYINT}, #{creator,jdbcType=VARCHAR}, #{gmtCreate,jdbcType=TIMESTAMP},
      #{modifier,jdbcType=VARCHAR}, #{gmtModified,jdbcType=TIMESTAMP}, #{isDeleted,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.sandu.api.springFestivalActivity.model.WxUserSignin" >
    insert into wx_user_signin
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="activityId != null" >
        activity_id,
      </if>
      <if test="userId != null" >
        user_id,
      </if>
      <if test="signinDate != null" >
        signin_date,
      </if>
      <if test="signinDay != null" >
        signin_day,
      </if>
      <if test="redPacketNum != null" >
        red_packet_num,
      </if>
      <if test="receiveStatus != null" >
        receive_status,
      </if>
      <if test="receiveTime != null" >
        receive_time,
      </if>
      <if test="haveLotteryChance != null" >
        have_lottery_chance,
      </if>
      <if test="isLotteryFlag != null" >
        is_lottery_flag,
      </if>
      <if test="creator != null" >
        creator,
      </if>
      <if test="gmtCreate != null" >
        gmt_create,
      </if>
      <if test="modifier != null" >
        modifier,
      </if>
      <if test="gmtModified != null" >
        gmt_modified,
      </if>
      <if test="isDeleted != null" >
        is_deleted,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=BIGINT},
      </if>
      <if test="activityId != null" >
        #{activityId,jdbcType=BIGINT},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=BIGINT},
      </if>
      <if test="signinDate != null" >
        #{signinDate,jdbcType=DATE},
      </if>
      <if test="signinDay != null" >
        #{signinDay,jdbcType=INTEGER},
      </if>
      <if test="redPacketNum != null" >
        #{redPacketNum,jdbcType=DECIMAL},
      </if>
      <if test="receiveStatus != null" >
        #{receiveStatus,jdbcType=TINYINT},
      </if>
      <if test="receiveTime != null" >
        #{receiveTime,jdbcType=TIMESTAMP},
      </if>
      <if test="haveLotteryChance != null" >
        #{haveLotteryChance,jdbcType=TINYINT},
      </if>
      <if test="isLotteryFlag != null" >
        #{isLotteryFlag,jdbcType=TINYINT},
      </if>
      <if test="creator != null" >
        #{creator,jdbcType=VARCHAR},
      </if>
      <if test="gmtCreate != null" >
        #{gmtCreate,jdbcType=TIMESTAMP},
      </if>
      <if test="modifier != null" >
        #{modifier,jdbcType=VARCHAR},
      </if>
      <if test="gmtModified != null" >
        #{gmtModified,jdbcType=TIMESTAMP},
      </if>
      <if test="isDeleted != null" >
        #{isDeleted,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.sandu.api.springFestivalActivity.model.WxUserSignin" >
    update wx_user_signin
    <set >
      <if test="activityId != null" >
        activity_id = #{activityId,jdbcType=BIGINT},
      </if>
      <if test="userId != null" >
        user_id = #{userId,jdbcType=BIGINT},
      </if>
      <if test="signinDate != null" >
        signin_date = #{signinDate,jdbcType=DATE},
      </if>
      <if test="signinDay != null" >
        signin_day = #{signinDay,jdbcType=INTEGER},
      </if>
      <if test="redPacketNum != null" >
        red_packet_num = #{redPacketNum,jdbcType=DECIMAL},
      </if>
      <if test="receiveStatus != null" >
        receive_status = #{receiveStatus,jdbcType=TINYINT},
      </if>
      <if test="receiveTime != null" >
        receive_time = #{receiveTime,jdbcType=TIMESTAMP},
      </if>
      <if test="haveLotteryChance != null" >
        have_lottery_chance = #{haveLotteryChance,jdbcType=TINYINT},
      </if>
      <if test="isLotteryFlag != null" >
        is_lottery_flag = #{isLotteryFlag,jdbcType=TINYINT},
      </if>
      <if test="creator != null" >
        creator = #{creator,jdbcType=VARCHAR},
      </if>
      <if test="gmtCreate != null" >
        gmt_create = #{gmtCreate,jdbcType=TIMESTAMP},
      </if>
      <if test="modifier != null" >
        modifier = #{modifier,jdbcType=VARCHAR},
      </if>
      <if test="gmtModified != null" >
        gmt_modified = #{gmtModified,jdbcType=TIMESTAMP},
      </if>
      <if test="isDeleted != null" >
        is_deleted = #{isDeleted,jdbcType=INTEGER},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.sandu.api.springFestivalActivity.model.WxUserSignin" >
    update wx_user_signin
    set activity_id = #{activityId,jdbcType=BIGINT},
      user_id = #{userId,jdbcType=BIGINT},
      signin_date = #{signinDate,jdbcType=DATE},
      signin_day = #{signinDay,jdbcType=INTEGER},
      red_packet_num = #{redPacketNum,jdbcType=DECIMAL},
      receive_status = #{receiveStatus,jdbcType=TINYINT},
      receive_time = #{receiveTime,jdbcType=TIMESTAMP},
      have_lottery_chance = #{haveLotteryChance,jdbcType=TINYINT},
      is_lottery_flag = #{isLotteryFlag,jdbcType=TINYINT},
      creator = #{creator,jdbcType=VARCHAR},
      gmt_create = #{gmtCreate,jdbcType=TIMESTAMP},
      modifier = #{modifier,jdbcType=VARCHAR},
      gmt_modified = #{gmtModified,jdbcType=TIMESTAMP},
      is_deleted = #{isDeleted,jdbcType=INTEGER}
    where id = #{id,jdbcType=BIGINT}
  </update>

    <select id="getSignInListByUserId" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM wx_user_signin
        WHERE activity_id = #{activityId,jdbcType=BIGINT}
        AND user_id = #{userId,jdbcType=BIGINT}
        AND is_deleted = 0
    </select>

    <select id="getWxUserSignInSelective" resultMap="BaseResultMap"
            parameterType="com.sandu.api.springFestivalActivity.model.WxUserSignin">
        SELECT <include refid="Base_Column_List"/>
        FROM wx_user_signin
        WHERE 1=1
        <if test="activityId != null" >
          AND activity_id = #{activityId,jdbcType=BIGINT}
        </if>
        <if test="userId != null" >
          AND user_id = #{userId,jdbcType=BIGINT}
        </if>
        <if test="signinDate != null" >
          AND signin_date = #{signinDate,jdbcType=DATE}
        </if>
        <if test="signinDay != null" >
          AND signin_day = #{signinDay,jdbcType=INTEGER}
        </if>
        <if test="redPacketNum != null" >
          AND red_packet_num = #{redPacketNum,jdbcType=DECIMAL}
        </if>
        <if test="receiveStatus != null" >
          AND receive_status = #{receiveStatus,jdbcType=TINYINT}
        </if>
        <if test="receiveTime != null" >
          AND receive_time = #{receiveTime,jdbcType=TIMESTAMP}
        </if>
        <if test="haveLotteryChance != null" >
          AND have_lottery_chance = #{haveLotteryChance,jdbcType=TINYINT}
        </if>
        <if test="isLotteryFlag != null" >
          AND is_lottery_flag = #{isLotteryFlag,jdbcType=TINYINT}
        </if>
        <if test="creator != null" >
          AND creator = #{creator,jdbcType=VARCHAR}
        </if>
        <if test="gmtCreate != null" >
          AND gmt_create = #{gmtCreate,jdbcType=TIMESTAMP}
        </if>
        <if test="modifier != null" >
          AND modifier = #{modifier,jdbcType=VARCHAR}
        </if>
        <if test="gmtModified != null" >
          AND gmt_modified = #{gmtModified,jdbcType=TIMESTAMP}
        </if>
        <if test="isDeleted != null" >
          AND is_deleted = #{isDeleted,jdbcType=INTEGER}
        </if>
    </select>

    <select id="getSignInCountOfUser" resultType="java.lang.Integer" >
        SELECT COUNT(1) FROM wx_user_signin WHERE
        activity_id = #{activityId,jdbcType=BIGINT} AND user_id = #{userId,jdbcType=BIGINT} AND is_deleted = 0
    </select>

    <update id="updateOneLotteryFlag">
        UPDATE wx_user_signin SET is_lottery_flag = 1
        WHERE activity_id = #{activityId,jdbcType=BIGINT}
        AND user_id = #{userId,jdbcType=BIGINT}
        AND have_lottery_chance = 1
        AND is_deleted = 0 ORDER BY gmt_create ASC LIMIT 1
    </update>

    <select id="getUserById" parameterType="integer" resultType="com.sandu.api.user.model.SysUser">
        SELECT * from sys_user where id = #{userId}
    </select>

  <!-- **更新定义** -->
  <update id="updateUser" parameterType="com.sandu.api.user.model.SysUser">
    update sys_user
    <set>
      <if test="sysCode!= null">  sys_code = #{sysCode,jdbcType=VARCHAR}, </if>
      <if test="brandIds!= null">  brand_ids = #{brandIds,jdbcType=VARCHAR}, </if>
      <if test="userImei!= null">  user_imei = #{userImei,jdbcType=VARCHAR}, </if>
      <if test="creator!= null">  creator = #{creator,jdbcType=VARCHAR}, </if>
      <if test="gmtCreate!= null">  gmt_create = #{gmtCreate,jdbcType=TIMESTAMP}, </if>
      <if test="modifier!= null">  modifier = #{modifier,jdbcType=VARCHAR}, </if>
      <if test="gmtModified!= null">  gmt_modified = #{gmtModified,jdbcType=TIMESTAMP}, </if>
      <if test="isDeleted!= null">  is_deleted = #{isDeleted,jdbcType=INTEGER}, </if>
      <if test="userName!= null">  user_name = #{userName,jdbcType=VARCHAR}, </if>
      <if test="nickName!= null">  nick_name = #{nickName,jdbcType=VARCHAR}, </if>
      <if test="password!= null">  password = #{password,jdbcType=VARCHAR}, </if>
      <if test="email!= null">  email = #{email,jdbcType=VARCHAR}, </if>
      <if test="mobile!= null">  mobile = #{mobile,jdbcType=VARCHAR}, </if>
      <if test="userType!= null">  user_type = #{userType,jdbcType=INTEGER}, </if>
      <if test="sex!= null">  sex = #{sex,jdbcType=INTEGER}, </if>
      <if test="job!= null">  job = #{job,jdbcType=VARCHAR}, </if>
      <if test="areaLongCode!= null">  area_long_code = #{areaLongCode,jdbcType=VARCHAR}, </if>
      <if test="areaId!= null">  area_id = #{areaId,jdbcType=INTEGER}, </if>
      <if test="picId!= null">  pic_id = #{picId,jdbcType=INTEGER}, </if>
      <if test="mediaType!= null">  media_type = #{mediaType,jdbcType=INTEGER}, </if>
      <if test="companyId!= null">  company_id = #{companyId}, </if>
      <if test="realName!= null"> real_name = #{realName,jdbcType=VARCHAR}, </if>
      <if test="qq!= null"> qq = #{qq,jdbcType=VARCHAR}, </if>
      <if test="companyTel!= null"> company_tel = #{companyTel,jdbcType=VARCHAR}, </if>
      <if test="companyAddress!= null"> company_address = #{companyAddress,jdbcType=VARCHAR}, </if>
      <if test="specialityValue!= null"> speciality_value = #{specialityValue,jdbcType=VARCHAR}, </if>
      <if test="intro!= null"> intro = #{intro,jdbcType=VARCHAR}, </if>
      <if test="emailVerifyState!= null"> email_verify_state = #{emailVerifyState,jdbcType=INTEGER}, </if>
      <if test="mobileVerifyState!= null"> mobile_verify_state = #{mobileVerifyState,jdbcType=INTEGER}, </if>
      <if test="idcardVerifyState!= null">  idcard_verify_state = #{idcardVerifyState,jdbcType=INTEGER}, </if>
      <if test="level!= null"> level = #{level,jdbcType=INTEGER}, </if>
      <if test="applicationDate!= null"> application_date = #{applicationDate,jdbcType=TIMESTAMP}, </if>
      <if test="verifyUser!= null"> verify_user = #{verifyUser,jdbcType=INTEGER}, </if>
      <if test="verifyDate!= null"> verify_date = #{verifyDate,jdbcType=TIMESTAMP}, </if>
      <if test="reasonRejected!= null"> reason_rejected = #{reasonRejected,jdbcType=VARCHAR}, </if>

      <if test="businessAdministrationId!= null"> business_administration_id = #{businessAdministrationId,jdbcType=VARCHAR}, </if>
      <if test="appKey!= null">  app_key = #{appKey,jdbcType=VARCHAR}, </if>
      <if test="token!= null">  token = #{token,jdbcType=VARCHAR}, </if>
      <if test="att3!= null">  att3 = #{att3,jdbcType=VARCHAR}, </if>
      <if test="att4!= null">  att4 = #{att4,jdbcType=VARCHAR}, </if>
      <if test="att5!= null">  att5 = #{att5,jdbcType=VARCHAR}, </if>
      <if test="att6!= null">  att6 = #{att6,jdbcType=VARCHAR}, </if>
      <if test="dateAtt1!= null">  date_att1 = #{dateAtt1,jdbcType=TIMESTAMP}, </if>
      <if test="dateAtt2!= null">  date_att2 = #{dateAtt2,jdbcType=TIMESTAMP}, </if>
      <if test="groupId!= null">  group_id = #{groupId,jdbcType=INTEGER}, </if>
      <if test="numAtt2!= null">  num_att2 = #{numAtt2,jdbcType=INTEGER}, </if>
      <if test="numAtt3!= null">  num_att3 = #{numAtt3,jdbcType=DOUBLE}, </if>
      <if test="numAtt4!= null">  num_att4 = #{numAtt4,jdbcType=DOUBLE}, </if>
      <if test="remark!= null">  remark = #{remark,jdbcType=VARCHAR}, </if>
      <if test="address != null">  address = #{address,jdbcType=VARCHAR}, </if>
      <if test="balanceAmount != null">  balance_amount = #{balanceAmount}, </if>
      <if test="consumAmount != null">  consum_amount = #{consumAmount} ,</if>
      <if test="existsMobile != null"> exists_mobile = #{existsMobile,jdbcType =INTEGER },</if>
      <if test="provinceCode != null"> province_code = #{provinceCode},</if>
      <if test="cityCode != null"> city_code = #{cityCode},</if>
      <if test="areaCode != null"> area_code = #{areaCode},</if>
      <if test="streetCode != null"> street_code = #{streetCode},</if>
      <if test="existsMobile == 1 and mobileOpenedDate == null and mobileClosedDate == null"> mobile_opened_date = CURDATE(),mobile_closed_date = DATE_ADD(CURDATE(),INTERVAL 1 YEAR),</if>
      <if test="existsMobile == 0 and mobileOpenedDate != null and mobileClosedDate != null"> mobile_opened_date = NULL,mobile_closed_date = NULL,</if>
      <if test="usedInvitationCode != null"> used_invitation_code = #{usedInvitationCode},</if>
      <if test="sourceCompany != null"> source_company = #{sourceCompany},</if>
      <if test="headPic != null"> head_pic = #{headPic},</if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
</mapper>