<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.nork.design.dao.DesignPlanRecommendedMapperV2">
<!--<cache type="org.mybatis.caches.ehcache.LoggingEhcache"/>-->
	<!-- **插入定义** -->
	<insert id="insertSelective" parameterType="com.nork.design.model.DesignPlanRecommended"  useGeneratedKeys="true" keyProperty="id">
		insert into design_plan_recommended
		<trim prefix="(" suffix=")" suffixOverrides=",">
		<if test="recommendedType!= null">recommended_type, </if>
		<if test="planId!= null">plan_id, </if>
		<if test="planCode!= null">plan_code, </if>
		<if test="planName!= null">plan_name, </if>
		<if test="planSource!= null">plan_source, </if>
		<if test="houseId!= null">house_id, </if>
		<if test="livingId!= null">living_id, </if>
		<if test="residentialUnitsName!= null">residential_units_name,</if>
		<if test="userId!= null">user_id, </if>
		<if test="mediaType!= null">media_type, </if>
		<if test="designSourceType!= null">design_source_type, </if>
		<if test="designId!= null">design_id, </if>
		<if test="designTemplateId!= null">design_template_id, </if>
		<if test="designStyleId!= null">design_style_id, </if>
		<if test="picId!= null">pic_id, </if>
		<if test="modelId!= null">model_id, </if>
		<if test="model3dId!= null">model_3d_id, </if>
		<if test="modelU3dId!= null">model_u3d_id, </if>
		<if test="webModelU3dId!= null">web_model_u3d_id, </if>
		<if test="iosModelU3dId!= null">ios_model_u3d_id, </if>
		<if test="ipadModelU3dId!= null">ipad_model_u3d_id, </if>
		<if test="pcModelU3dId!= null">pc_model_u3d_id, </if>
		<if test="androidModelU3dId!= null">android_model_u3d_id, </if>
		<if test="macBookpcModelU3dId!= null">macBookpc_model_u3d_id, </if>
		<if test="configFileId!= null">config_file_id, </if>
		<if test="planDesc!= null">plan_desc, </if>
		<if test="spaceCommonId!= null">space_common_id, </if>
		<if test="designPlanRenderPicIds!= null">designPlan_render_pic_ids, </if>
		<if test="sysCode!= null">sys_code, </if>
		<if test="creator!= null">creator, </if>
		<if test="gmtCreate!= null">gmt_create, </if>
		<if test="modifier!= null">modifier, </if>
		<if test="gmtModified!= null">gmt_modified, </if>
		<if test="isDeleted!= null">is_deleted, </if>
		<if test="remark!= null">remark, </if>
		<if test="shareTotal!= null">share_total, </if>
		<if test="isOpen!= null">is_open, </if>
		<if test="isChange!= null">is_change, </if>
		<if test="isDecorated!= null">is_decorated, </if>
		<if test="draftState!= null">draft_state, </if>
		<if test="baiMoState!= null">baiMo_state, </if>
		<if test="stuffFinishState!= null">stuff_finish_state, </if>
		<if test="decorateFinishState!= null">decorate_finish_state, </if>
		<if test="coverPicId!= null">cover_pic_Id, </if>
		<if test="isRelease!= null">is_release, </if>
		<if test="releaseTime!= null">release_time, </if>
		<if test="designRecommendedStyleId!= null">design_recommended_style_id, </if>
		<if test="isRecommended!= null">is_recommended, </if>
		<if test="isDefaultDecorate!= null">is_default_decorate, </if>
		<if test="planNumber!= null">plan_number, </if>
		<if test="applySpaceAreas!= null">apply_space_areas, </if>
		
		<if test="spellingFlowerFileId!= null">spelling_flower_file_id, </if>
		<if test="spellingFlowerProduct!= null">spelling_flower_product, </if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
		<if test="recommendedType!= null">#{recommendedType,jdbcType=INTEGER}, </if>
		<if test="planId!= null">#{planId,jdbcType=INTEGER}, </if>
		<if test="planCode!= null">  #{planCode,jdbcType=VARCHAR}, </if>
		<if test="planName!= null">  #{planName,jdbcType=VARCHAR}, </if>
		<if test="planSource!= null"> #{planSource,jdbcType=VARCHAR},</if>
		<if test="houseId!= null">  #{houseId,jdbcType=INTEGER}, </if>
		<if test="livingId!= null">  #{livingId,jdbcType=INTEGER}, </if>
		<if test="residentialUnitsName!= null">#{residentialUnitsName,jdbcType=VARCHAR},</if>
		<if test="userId!= null">  #{userId,jdbcType=INTEGER}, </if>
		<if test="mediaType!= null">  #{mediaType,jdbcType=INTEGER}, </if>
		<if test="designSourceType!= null">  #{designSourceType,jdbcType=INTEGER}, </if>
		<if test="designId!= null">  #{designId,jdbcType=INTEGER}, </if>
		<if test="designTemplateId!= null">  #{designTemplateId,jdbcType=INTEGER}, </if>
		<if test="designStyleId!= null">  #{designStyleId,jdbcType=INTEGER}, </if>
		<if test="picId!= null">  #{picId,jdbcType=INTEGER}, </if>
		<if test="modelId!= null">  #{modelId,jdbcType=INTEGER}, </if>
		<if test="model3dId!= null">  #{model3dId,jdbcType=INTEGER}, </if>
		<if test="modelU3dId!= null">  #{modelU3dId,jdbcType=INTEGER}, </if>
		<if test="webModelU3dId!= null">  #{webModelU3dId,jdbcType=INTEGER}, </if>
		<if test="iosModelU3dId!= null">  #{iosModelU3dId,jdbcType=INTEGER}, </if>
		<if test="ipadModelU3dId!= null">  #{ipadModelU3dId,jdbcType=INTEGER}, </if>
		<if test="pcModelU3dId!= null">  #{pcModelU3dId,jdbcType=INTEGER}, </if>
		<if test="androidModelU3dId!= null">  #{androidModelU3dId,jdbcType=INTEGER}, </if>
		<if test="macBookpcModelU3dId!= null">  #{macBookpcModelU3dId,jdbcType=INTEGER}, </if>
		<if test="configFileId!= null">  #{configFileId,jdbcType=INTEGER}, </if>
		<if test="spaceCommonId!= null">  #{spaceCommonId,jdbcType=INTEGER}, </if>
		<if test="designPlanRenderPicIds!= null">  #{designPlanRenderPicIds,jdbcType=VARCHAR}, </if>
		<if test="planDesc!= null">  #{planDesc,jdbcType=VARCHAR}, </if>
		<if test="sysCode!= null">  #{sysCode,jdbcType=VARCHAR}, </if>
		<if test="creator!= null">  #{creator,jdbcType=VARCHAR}, </if>
		<if test="gmtCreate!= null">  #{gmtCreate,jdbcType=TIMESTAMP}, </if>
		<if test="modifier!= null">  #{modifier,jdbcType=VARCHAR}, </if>
		<if test="gmtModified!= null">  #{gmtModified,jdbcType=TIMESTAMP}, </if>
		<if test="isDeleted!= null">  #{isDeleted,jdbcType=INTEGER}, </if>
		<if test="remark!= null">  #{remark,jdbcType=VARCHAR}, </if>
		<if test="shareTotal!= null">#{shareTotal,jdbcType=INTEGER}, </if>
		<if test="isOpen!= null">#{isOpen,jdbcType=INTEGER}, </if>
		<if test="isChange!= null">#{isChange,jdbcType=INTEGER}, </if>
		<if test="isDecorated!= null">#{isDecorated,jdbcType=INTEGER}, </if>
		<if test="draftState!= null">#{draftState,jdbcType=INTEGER}, </if>
		<if test="baiMoState!= null">#{baiMoState,jdbcType=INTEGER}, </if>
		<if test="stuffFinishState!= null">#{stuffFinishState,jdbcType=INTEGER}, </if>
		<if test="decorateFinishState!= null">#{decorateFinishState,jdbcType=INTEGER}, </if>
		<if test="coverPicId!= null">#{coverPicId,jdbcType=INTEGER}, </if>
		<if test="isRelease!= null">#{isRelease,jdbcType=INTEGER}, </if>
		<if test="releaseTime!= null">#{releaseTime,jdbcType=TIMESTAMP}, </if>
		<if test="designRecommendedStyleId!= null">#{designRecommendedStyleId,jdbcType=INTEGER}, </if>
 		<if test="isRecommended!= null">#{isRecommended,jdbcType=INTEGER}, </if>
		<if test="isDefaultDecorate!= null">#{isDefaultDecorate,jdbcType=INTEGER}, </if>
		<if test="planNumber!= null">#{planNumber,jdbcType=VARCHAR}, </if>
		<if test="applySpaceAreas!= null"> #{applySpaceAreas,jdbcType=VARCHAR}, </if>
		
		<if test="spellingFlowerFileId!= null">#{spellingFlowerFileId,jdbcType=INTEGER}, </if>
		<if test="spellingFlowerProduct!= null">#{spellingFlowerProduct,jdbcType=VARCHAR}, </if>
		</trim>
	</insert>

	<!-- **更新定义** -->
	<update id="updateByPrimaryKeySelective" parameterType="com.nork.design.model.DesignPlanRecommended">
		update design_plan_recommended
		<set>
		<if test="planId!= null">plan_id = #{planId,jdbcType=INTEGER}, </if>
		<if test="recommendedType!= null"> recommended_type = #{recommendedType,jdbcType=INTEGER}, </if>
		<if test="planCode!= null">  plan_code = #{planCode,jdbcType=VARCHAR}, </if>
		<if test="planName!= null">  plan_name = #{planName,jdbcType=VARCHAR}, </if>
		<if test="userId!= null">  user_id = #{userId,jdbcType=INTEGER}, </if>
		<if test="mediaType!= null">  media_type = #{mediaType,jdbcType=INTEGER}, </if>
		<if test="designSourceType!= null">  design_source_type = #{designSourceType,jdbcType=INTEGER}, </if>
		<if test="designId!= null">  design_id = #{designId,jdbcType=INTEGER}, </if>
		<if test="designTemplateId!= null">  design_template_id = #{designTemplateId,jdbcType=INTEGER}, </if>
		<if test="designStyleId!= null">  design_style_id = #{designStyleId,jdbcType=INTEGER}, </if>
		<if test="picId!= null">  pic_id = #{picId,jdbcType=INTEGER}, </if>
		<if test="modelId!= null">  model_id = #{modelId,jdbcType=INTEGER}, </if>
		<if test="model3dId!= null">  model_3d_id = #{model3dId,jdbcType=INTEGER}, </if>
		<if test="modelU3dId!= null">  model_u3d_id = #{modelU3dId,jdbcType=INTEGER}, </if>
		<if test="webModelU3dId!= null">  web_model_u3d_id = #{webModelU3dId,jdbcType=INTEGER}, </if>
		<if test="iosModelU3dId!= null">  ios_model_u3d_id = #{iosModelU3dId,jdbcType=INTEGER}, </if>
		<if test="pcModelU3dId!= null">  pc_model_u3d_id = #{pcModelU3dId,jdbcType=INTEGER}, </if>
		<if test="ipadModelU3dId!= null">  ipad_model_u3d_id = #{ipadModelU3dId,jdbcType=INTEGER}, </if>
		<if test="androidModelU3dId!= null">  android_model_u3d_id = #{androidModelU3dId,jdbcType=INTEGER}, </if>
		<if test="macBookpcModelU3dId!= null">  macBookpc_model_u3d_id = #{macBookpcModelU3dId,jdbcType=INTEGER}, </if>
		<if test="configFileId!= null">  config_file_id = #{configFileId,jdbcType=INTEGER}, </if>
		<if test="spaceCommonId!= null">  space_common_id = #{spaceCommonId,jdbcType=INTEGER}, </if>
		<if test="designPlanRenderPicIds!= null"> designPlan_render_pic_ids = #{designPlanRenderPicIds,jdbcType=VARCHAR}, </if>
		<if test="planDesc!= null">  plan_desc = #{planDesc,jdbcType=VARCHAR}, </if>
		<if test="sysCode!= null">  sys_code = #{sysCode,jdbcType=VARCHAR}, </if>
		<if test="creator!= null">  creator = #{creator,jdbcType=VARCHAR}, </if>
		<if test="gmtCreate!= null">  gmt_create = #{gmtCreate,jdbcType=TIMESTAMP}, </if>
		<if test="modifier!= null">  modifier = #{modifier,jdbcType=VARCHAR}, </if>
		<if test="gmtModified!= null">  gmt_modified = #{gmtModified,jdbcType=TIMESTAMP}, </if>
		<if test="isDeleted!= null">  is_deleted = #{isDeleted,jdbcType=INTEGER}, </if>
		<if test="remark!= null">  remark = #{remark,jdbcType=VARCHAR}, </if>
		<if test="shareTotal!= null">  share_total = #{shareTotal,jdbcType=INTEGER}, </if>
		<if test="isOpen!= null">  is_open = #{isOpen,jdbcType=INTEGER}, </if>
		<if test="isChange!= null">  is_change = #{isChange,jdbcType=INTEGER}, </if>
		<if test="isDecorated!= null">  is_decorated = #{isDecorated,jdbcType=INTEGER}, </if>
		<if test="isDecorated!= null">  is_decorated = #{isDecorated,jdbcType=INTEGER}, </if>
		<if test="draftState!= null">  draft_state = #{draftState,jdbcType=INTEGER}, </if>
		<if test="baiMoState!= null">  baiMo_state = #{baiMoState,jdbcType=INTEGER}, </if>
		<if test="stuffFinishState!= null">  stuff_finish_state = #{stuffFinishState,jdbcType=INTEGER}, </if>
		<if test="decorateFinishState!= null">  decorate_finish_state = #{decorateFinishState,jdbcType=INTEGER}, </if>
		<if test="coverPicId!= null">cover_pic_Id = #{coverPicId,jdbcType=INTEGER}, </if>
		<if test="isRelease!= null">is_release = #{isRelease,jdbcType=INTEGER}, </if>
		<if test="releaseTime!= null">release_time =#{releaseTime,jdbcType=TIMESTAMP}, </if>
		<if test="designRecommendedStyleId!= null">design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER}, </if>
		<if test="effectsConfig!= null">effects_config = #{effectsConfig,jdbcType=VARCHAR}, </if>
		<if test="isRecommended!= null">is_recommended = #{isRecommended,jdbcType=INTEGER}, </if>
		<if test="isDefaultDecorate!= null">is_default_decorate = #{isDefaultDecorate,jdbcType=INTEGER}, </if>
		<if test="planNumber!= null"> plan_number = #{planNumber,jdbcType=VARCHAR}, </if>
		<if test="applySpaceAreas!= null">apply_space_areas =  #{applySpaceAreas,jdbcType=VARCHAR}, </if>
		
		<if test="spellingFlowerFileId!= null">spelling_flower_file_id = #{spellingFlowerFileId,jdbcType=INTEGER}, </if>
		<if test="spellingFlowerProduct!= null">spelling_flower_product = #{spellingFlowerProduct,jdbcType=VARCHAR}, </if>
		</set>
		where id = #{id,jdbcType=INTEGER}
	</update>

	<!-- **删除定义** -->
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		delete from design_plan_recommended
		where id = #{id,jdbcType=INTEGER}
	</delete>
	
	<!-- **常量定义** -->
	<sql id="All_Column_List">
 

		id,spelling_flower_product,spelling_flower_file_id,plan_id,recommended_type,is_recommended,is_default_decorate,plan_number,design_recommended_style_id,release_time,is_release,cover_pic_Id,plan_code,plan_name,plan_source,house_id,living_id,residential_units_name,user_id,media_type,design_source_type,design_id,share_total,is_open,is_change,
		is_decorated,draft_state,baiMo_state,stuff_finish_state,decorate_finish_state,design_template_id,design_style_id,pic_id,model_id,model_3d_id,model_u3d_id,web_model_u3d_id,ios_model_u3d_id,ipad_model_u3d_id,pc_model_u3d_id,
		android_model_u3d_id,macBookpc_model_u3d_id,config_file_id,space_common_id,designPlan_render_pic_ids,plan_desc,sys_code,creator,gmt_create,modifier,gmt_modified,is_deleted,remark,evening_file_id,dawn_file_id,night_file_id,effects_config,apply_space_areas
 
	</sql>
	
	<!-- **结果定义** -->
	<resultMap id="AllResultMap" type="com.nork.design.model.DesignPlanRecommended">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result  column="recommended_type" property="recommendedType" jdbcType="INTEGER" />
		<result  column="plan_id" property="planId" jdbcType="INTEGER" />
		<result  column="plan_code" property="planCode" jdbcType="VARCHAR" />
		<result  column="plan_name" property="planName" jdbcType="VARCHAR" />
		<result column="plan_source" property="planSource" jdbcType="VARCHAR"/>
		<result column="house_id" property="houseId" jdbcType="INTEGER"/>
		<result column="living_id" property="livingId" jdbcType="INTEGER"/>
		<result column="residential_units_name" property="residentialUnitsName" jdbcType="VARCHAR"/>
		<result  column="user_id" property="userId" jdbcType="INTEGER" />
		<result  column="media_type" property="mediaType" jdbcType="INTEGER" />
		<result  column="design_source_type" property="designSourceType" jdbcType="INTEGER" />
		<result  column="design_id" property="designId" jdbcType="INTEGER" />
		<result  column="design_template_id" property="designTemplateId" jdbcType="INTEGER" />
		<result  column="design_style_id" property="designStyleId" jdbcType="INTEGER" />
		<result  column="pic_id" property="picId" jdbcType="INTEGER" />
		<result  column="model_id" property="modelId" jdbcType="INTEGER" />
		<result  column="model_3d_id" property="model3dId" jdbcType="INTEGER" />
		<result  column="model_u3d_id" property="modelU3dId" jdbcType="INTEGER" />
		<result  column="web_model_u3d_id" property="webModelU3dId" jdbcType="INTEGER" />
		<result  column="ios_model_u3d_id" property="iosModelU3dId" jdbcType="INTEGER" />
		<result  column="ipad_model_u3d_id" property="ipadModelU3dId" jdbcType="INTEGER" />
		<result  column="pc_model_u3d_id" property="pcModelU3dId" jdbcType="INTEGER" />
		<result  column="android_model_u3d_id" property="androidModelU3dId" jdbcType="INTEGER" />
		<result  column="macBookpc_model_u3d_id" property="macBookpcModelU3dId" jdbcType="INTEGER" />
		<result  column="config_file_id" property="configFileId" jdbcType="INTEGER" />
		<result  column="space_common_id" property="spaceCommonId" jdbcType="INTEGER" />
		<result  column="designPlan_render_pic_ids" property="designPlanRenderPicIds" jdbcType="VARCHAR" />
		<result  column="space_function_id" property="spaceFunctionId" jdbcType="INTEGER" />
		<result  column="space_areas" property="spaceAreas" jdbcType="VARCHAR" />
		<result  column="plan_desc" property="planDesc" jdbcType="VARCHAR" />
		<result  column="sys_code" property="sysCode" jdbcType="VARCHAR" />
		<result  column="creator" property="creator" jdbcType="VARCHAR" />
		<result  column="gmt_create" property="gmtCreate" jdbcType="TIMESTAMP" />
		<result  column="modifier" property="modifier" jdbcType="VARCHAR" />
		<result  column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP" />
		<result  column="is_deleted" property="isDeleted" jdbcType="INTEGER" />
		<result  column="remark" property="remark" jdbcType="VARCHAR" />
		<result  column="share_total" property="shareTotal" jdbcType="INTEGER" />
		<result  column="is_open" property="isOpen" jdbcType="INTEGER" />
		<result  column="is_change" property="isChange" jdbcType="INTEGER" />
		<result  column="is_decorated" property="isDecorated" jdbcType="INTEGER" />
		<result  column="draft_state" property="draftState" jdbcType="INTEGER" />
		<result  column="baiMo_state" property="baiMoState" jdbcType="INTEGER" />
		<result  column="stuff_finish_state" property="stuffFinishState" jdbcType="INTEGER" />
		<result  column="decorate_finish_state" property="decorateFinishState" jdbcType="INTEGER" />
		<result  column="cover_pic_Id" property="coverPicId" jdbcType="INTEGER" />
		<result  column="is_release" property="isRelease" jdbcType="INTEGER" />
		<result  column="release_time" property="releaseTime" jdbcType="TIMESTAMP" />
		<result  column="design_recommended_style_id" property="designRecommendedStyleId" jdbcType="INTEGER" />
 		<result  column="effects_config" property="effectsConfig" jdbcType="VARCHAR" />
 		<result  column="is_recommended" property="isRecommended" jdbcType="INTEGER" />
 		<result  column="is_default_decorate" property="isDefaultDecorate" jdbcType="INTEGER" />
 		<result  column="plan_number" property="planNumber" jdbcType="VARCHAR" />
		<result  column="apply_space_areas" property="applySpaceAreas" jdbcType="VARCHAR" />
		
		<result  column="spelling_flower_file_id" property="spellingFlowerFileId" jdbcType="INTEGER" />
		<result  column="spelling_flower_product" property="spellingFlowerProduct" jdbcType="INTEGER" />
	</resultMap>
	
	<!-- **查询定义** -->
	<!-- 按主键查询 -->
	<select id="selectByPrimaryKey" resultMap="AllResultMap"
		parameterType="java.lang.Integer">
		select
		<include refid="All_Column_List" />
		from design_plan_recommended
		where id = #{id,jdbcType=INTEGER}
	</select>
	

	
	<!-- 查询所有，可排序 -->
    <select id="selectList" resultMap="AllResultMap"
		parameterType="com.nork.design.model.DesignPlanRecommended">
		select
		<include refid="All_Column_List" />
		from design_plan_recommended
        where 1=1
        <if test="spellingFlowerProduct!= null">and spelling_flower_product = #{spellingFlowerProduct,jdbcType=VARCHAR} </if>
        <if test="spellingFlowerFileId!= null">and spelling_flower_file_id = #{spellingFlowerFileId,jdbcType=INTEGER}  </if>
        
        <if test="planId!= null">and plan_id = #{planId,jdbcType=INTEGER} </if>
        <if test="recommendedType!= null">and recommended_type = #{recommendedType,jdbcType=INTEGER} </if>
 		<if test="isRecommended!= null">and is_recommended = #{isRecommended,jdbcType=INTEGER}  </if>
		<if test="isDefaultDecorate!= null">and is_default_decorate = #{isDecorate,jdbcType=INTEGER}  </if>
		<if test="planNumber!= null">and plan_number = #{planNumber,jdbcType=VARCHAR}  </if>
        <if test="designRecommendedStyleId!= null">and   design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER} </if>
        <if test="releaseTime!= null">and release_time =#{releaseTime,jdbcType=TIMESTAMP}  </if>
        <if test="isRelease!= null"> and is_release = #{isRelease,jdbcType=INTEGER}  </if>
        <if test="coverPicId!= null">and cover_pic_Id = #{coverPicId,jdbcType=INTEGER} </if>
		<if test="id!= null">  and id = #{id,jdbcType=INTEGER} </if>
		<if test="planCode!= null">  and plan_code = #{planCode,jdbcType=VARCHAR} </if>
		<if test="planName!= null">  and plan_name = #{planName,jdbcType=VARCHAR} </if>
		<if test="userId!= null">  and user_id = #{userId,jdbcType=INTEGER} </if>
		<if test="mediaType!= null">  and media_type = #{mediaType,jdbcType=INTEGER} </if>
		<if test="designSourceType!= null">  and design_source_type = #{designSourceType,jdbcType=INTEGER} </if>
		<if test="designId!= null">  and design_id = #{designId,jdbcType=INTEGER} </if>
		<if test="designStyleId!= null">  and design_style_id = #{designStyleId,jdbcType=INTEGER} </if>
		<if test="picId!= null">  and pic_id = #{picId,jdbcType=INTEGER} </if>
		<if test="modelId!= null">  and model_id = #{modelId,jdbcType=INTEGER} </if>
		<if test="model3dId!= null">  and model_3d_id = #{model3dId,jdbcType=INTEGER} </if>
		<if test="modelU3dId!= null">  and model_u3d_id = #{modelU3dId,jdbcType=INTEGER} </if>
		<if test="webModelU3dId!= null">  and web_model_u3d_id = #{webModelU3dId,jdbcType=INTEGER} </if>
		<if test="configFileId!= null">  and config_file_id = #{configFileId,jdbcType=INTEGER} </if>
		<if test="spaceCommonId!= null">  and space_common_id = #{spaceCommonId,jdbcType=INTEGER} </if>
		<if test="designPlanRenderPicIds!= null">  and LOCATE(#{designPlanRenderPicIds,jdbcType=VARCHAR},designPlan_render_pic_ids) > 0, </if>
		<if test="planDesc!= null">  and plan_desc = #{planDesc,jdbcType=VARCHAR} </if>
		<if test="draftState!= null">  and draft_state = #{draftState,jdbcType=INTEGER} </if>
		<if test="baiMoState!= null">  and baiMo_state = #{baiMoState,jdbcType=INTEGER} </if>
		<if test="stuffFinishState!= null">  and stuff_finish_state = #{stuffFinishState,jdbcType=INTEGER} </if>
		<if test="decorateFinishState!= null">  and decorate_finish_state = #{decorateFinishState,jdbcType=INTEGER} </if>
		<if test="sysCode!= null">  and sys_code = #{sysCode,jdbcType=VARCHAR} </if>
		<if test="creator!= null">  and creator = #{creator,jdbcType=VARCHAR} </if>
		<if test="gmtCreate!= null">  and gmt_create = #{gmtCreate,jdbcType=TIMESTAMP} </if>
		<if test="modifier!= null">  and modifier = #{modifier,jdbcType=VARCHAR} </if>
		<if test="gmtModified!= null">  and gmt_modified = #{gmtModified,jdbcType=TIMESTAMP} </if>
		<if test="isDeleted!= null">  and is_deleted = #{isDeleted,jdbcType=INTEGER} </if>
		
		<if test="order != null and  order !=''  ">
			order by ${order}
			<if test="orderNum != null and  orderNum !='' ">
				${orderNum}
			</if>
		</if>
		<if test="orders != null and  orders !=''  ">
		   order by ${orders}
		</if>
	</select>
	
	<!-- 分页汇总 -->
	<select id="selectCount" resultType="int"
		parameterType="com.nork.design.model.DesignPlanRecommended">
		select count(*)
		from design_plan_recommended
		where 1=1
		<if test="spellingFlowerProduct!= null">and spelling_flower_product = #{spellingFlowerProduct,jdbcType=VARCHAR} </if>
        <if test="spellingFlowerFileId!= null">and spelling_flower_file_id = #{spellingFlowerFileId,jdbcType=INTEGER}  </if>
        
		<if test="planId!= null">and plan_id = #{planId,jdbcType=INTEGER} </if>
		<if test="recommendedType!= null">and recommended_type = #{recommendedType,jdbcType=INTEGER} </if>
 		<if test="isRecommended!= null">and is_recommended = #{isRecommended,jdbcType=INTEGER}  </if>
		<if test="isDefaultDecorate!= null">and is_default_decorate = #{isDecorate,jdbcType=INTEGER}  </if>
		<if test="planNumber!= null">and plan_number = #{planNumber,jdbcType=VARCHAR}  </if>
        <if test="designRecommendedStyleId!= null">and   design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER} </if>
        <if test="releaseTime!= null">and release_time =#{releaseTime,jdbcType=TIMESTAMP}  </if>
        <if test="isRelease!= null"> and is_release = #{isRelease,jdbcType=INTEGER}  </if>
        <if test="coverPicId!= null">and cover_pic_Id = #{coverPicId,jdbcType=INTEGER} </if>
		<if test="id!= null">  and id = #{id,jdbcType=INTEGER} </if>
		<if test="planCode!= null">  and plan_code = #{planCode,jdbcType=VARCHAR} </if>
		<if test="planName!= null">  and plan_name = #{planName,jdbcType=VARCHAR} </if>
		<if test="userId!= null">  and user_id = #{userId,jdbcType=INTEGER} </if>
		<if test="mediaType!= null">  and media_type = #{mediaType,jdbcType=INTEGER} </if>
		<if test="designSourceType!= null">  and design_source_type = #{designSourceType,jdbcType=INTEGER} </if>
		<if test="designId!= null">  and design_id = #{designId,jdbcType=INTEGER} </if>
		<if test="designStyleId!= null">  and design_style_id = #{designStyleId,jdbcType=INTEGER} </if>
		<if test="picId!= null">  and pic_id = #{picId,jdbcType=INTEGER} </if>
		<if test="modelId!= null">  and model_id = #{modelId,jdbcType=INTEGER} </if>
		<if test="model3dId!= null">  and model_3d_id = #{model3dId,jdbcType=INTEGER} </if>
		<if test="modelU3dId!= null">  and model_u3d_id = #{modelU3dId,jdbcType=INTEGER} </if>
		<if test="webModelU3dId!= null">  and web_model_u3d_id = #{webModelU3dId,jdbcType=INTEGER} </if>
		<if test="configFileId!= null">  and config_file_id = #{configFileId,jdbcType=INTEGER} </if>
		<if test="spaceCommonId!= null">  and space_common_id = #{spaceCommonId,jdbcType=INTEGER} </if>
		<if test="designPlanRenderPicIds!= null">  and LOCATE(#{designPlanRenderPicIds,jdbcType=VARCHAR},designPlan_render_pic_ids) > 0, </if>
		<if test="planDesc!= null">  and plan_desc = #{planDesc,jdbcType=VARCHAR} </if>
		<if test="draftState!= null">  and draft_state = #{draftState,jdbcType=INTEGER} </if>
		<if test="baiMoState!= null">  and baiMo_state = #{baiMoState,jdbcType=INTEGER} </if>
		<if test="stuffFinishState!= null">  and stuff_finish_state = #{stuffFinishState,jdbcType=INTEGER} </if>
		<if test="decorateFinishState!= null">  and decorate_finish_state = #{decorateFinishState,jdbcType=INTEGER} </if>
		<if test="sysCode!= null">  and sys_code = #{sysCode,jdbcType=VARCHAR} </if>
		<if test="creator!= null">  and creator = #{creator,jdbcType=VARCHAR} </if>
		<if test="gmtCreate!= null">  and gmt_create = #{gmtCreate,jdbcType=TIMESTAMP} </if>
		<if test="modifier!= null">  and modifier = #{modifier,jdbcType=VARCHAR} </if>
		<if test="gmtModified!= null">  and gmt_modified = #{gmtModified,jdbcType=TIMESTAMP} </if>
		<if test="isDeleted!= null">  and is_deleted = #{isDeleted,jdbcType=INTEGER} </if>
	</select>
 
 	<!-- 方案推荐总条数 -->
	<select id="getPlanRecommendedCount" resultType="int" parameterType="com.nork.design.model.DesignPlanRecommended">

			select  COUNT(DISTINCT dp.id)
			from design_plan_recommended AS dp
			<!--添加平台过滤-->
			<if test="platformId != null">
				LEFT JOIN design_plan_2b_platform AS dpp ON dpp.plan_id = dp.id
			</if>
	      left join
			(SELECT fid,recommendId,bid from design_plan_recommend_favorite_ref where status = 1 and fid in
			(SELECT bid from sys_business_favorite where userId =#{userId}) ) AS fr ON (fr.recommendId = dp.id)
			LEFT JOIN sys_user  su  ON dp.user_id = su.id AND su.is_deleted = 0
			LEFT JOIN  res_render_pic rrp ON dp.cover_pic_id = rrp.id AND rrp.is_deleted = 0 AND rrp.plan_recommended_id IS NOT NULL
			LEFT JOIN design_plan_brand dpb  ON dp.id = dpb.plan_id and dpb.is_deleted = 0
			LEFT JOIN  base_brand   AS bb   ON dpb.brand_id = bb.id AND bb.is_deleted = 0
			LEFT JOIN design_templet AS dt  ON (dp.design_template_id = dt.id)
			LEFT JOIN  space_common   sc   ON (sc.id = dt.space_common_id AND sc.is_deleted = 0)
			LEFT JOIN space_common scs ON dp.space_Common_Id =scs.id AND scs.is_deleted =0
			<if test="livingName != null and livingName !='' ">
				LEFT JOIN (SELECT standard_space_id,house_id from house_space where is_deleted = 0)as hs ON (hs.standard_space_id = sc.id)
				LEFT JOIN (SELECT id,living_id from base_house where is_deleted = 0) AS bh ON (hs.house_id = bh.id)
				LEFT JOIN (SELECT id,living_name FROM base_living ) as bl ON (bl.id = bh.living_id)
			</if>
			LEFT JOIN base_product_style AS bps ON (bps.id = dp.design_recommended_style_id)
			LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND type = 'houseType' ) AS sd ON (sc.space_function_id = sd.VALUE)
			LEFT JOIN  plan_decorate_price pdp on pdp.plan_recommend_id = dp.id

			WHERE
				dp.is_deleted = 0

			<!--添加平台过滤-->
			<if test="platformId != null">
				AND dpp.platform_id = #{platformId,jdbcType=INTEGER} AND dpp.putaway_state = 1 AND dpp.allot_state = 1
			</if>
				<!-- 	如果是审核管理员	 -->
		<if test="checkAdministrator != null and checkAdministrator == 'yes' ">
			<if test="spaceFunctionIds != null and spaceFunctionIds.size() >0">
				AND	sc.space_function_id in 
				<foreach collection="spaceFunctionIds" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</if>
		<!-- 	如果不是审核管理员	 -->
		<if test="checkAdministrator == null or checkAdministrator != 'yes' ">

			<if test="spaceFunctionId!= null">
				AND	sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
			</if>
		</if>

		<if test="planNumber!= null and planNumber!= '' ">
			AND	dp.plan_number = #{planNumber,jdbcType=VARCHAR}
		</if>
		<if test="isRelease != null">
			AND dp.is_release =  #{isRelease,jdbcType=INTEGER}
		</if>
		<if test="companyIds != null and companyIds.size() >0">
			AND ( dpb.company_id in
			<foreach collection="companyIds" index="index" item="item" open="(" separator="," close=")">
				#{item}
			</foreach>
			or dp.company_id in
			<foreach collection="companyIds" index="index" item="item" open="(" separator="," close=")">
				#{item}
			</foreach> )
		</if>
		<!--经销商要进行关联品牌的过滤-->
		<if test="brandIds != null and brandIds.size() > 0">
			AND ( dpb.brand_id in
			<foreach collection="brandIds" index="index" item="item" open="(" separator="," close=")">
				#{item}
			</foreach>
			or dpb.brand_id is null)
		</if>
		<if test="isReleases != null and isReleases.size() >0">
				AND	dp.is_release in 
				<foreach collection="isReleases" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
		</if>
		<if test="recommendedType != null">
			AND dp.recommended_type = #{recommendedType,jdbcType=INTEGER}
		</if>

	<!--	<if test="recommendedType != null and recommendedType == 2">
			and LOCATE('ONEKEY',IFNULL(dp.shelf_status,'-')) > 0
		</if>-->

		<if test="designRecommendedStyleId!= null">
			AND dp.design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER} 
		</if>
		<!-- 如果没有样板房面积相关数据，则只显示主方案，有样板房面积就显示所有方案 -->
		<!-- 改为如果没有样板房面积相关数据，则显示主方案或没有打组的方案，有样板房面积就显示没有打组的适合的方案和所有主方案
             即所有主方案始终显示，因为产品说组合方案适用所有面积，没有打组的方案：才会有面积过滤  2018.09.08 add by gaoj-->
		and ( dp.group_primary_id = dp.id or ( dp.group_primary_id = 0
		<choose>
			<when test="areaValue== null or areaValue==''">
				) )
			</when>
			<otherwise>
				and (FIND_IN_SET(#{areaValue,jdbcType=VARCHAR},dp.apply_space_areas) or dp.apply_space_areas = '') ) )
			</otherwise>
		</choose>
		<!-- 如果没有样板房面积相关数据，则只显示主方案，有样板房面积就显示所有方案 -->
		<!--<if test="areaValue== null or areaValue==''">-->
			<!--AND (dp.group_primary_id = 0 OR dp.group_primary_id = dp.id)-->
		<!--</if>-->
		<!--<if test="areaValue!= null and areaValue!=''">-->
			<!--AND (FIND_IN_SET(#{areaValue,jdbcType=VARCHAR},dp.apply_space_areas) or dp.apply_space_areas = '')-->
		<!--</if>-->
		<!-- 装修报价类型筛选 -->
		<if test="decoratePriceType != null">
			and pdp.decorate_price_type = #{decoratePriceType,jdbcType=INTEGER}
			<if test="decoratePriceRange != null">
				and pdp.decorate_price_range = #{decoratePriceRange,jdbcType=INTEGER}
			</if>
		</if>
		<choose>

			<when test="creator != null and creator != '' and brandName != null and brandName != '' and livingName != null and livingName !='' and planName != null and planName != '' ">

                AND (
                	dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
                    or su.user_name like CONCAT(CONCAT('%',#{creator,jdbcType=VARCHAR}),'%')
                    or bb.brand_name like CONCAT(CONCAT('%',#{brandName,jdbcType=VARCHAR}),'%')
                    or bl.living_name like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
                    or dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
                )
            </when>
			<otherwise>
				<if test="planName!= null and planName!= '' ">
					AND dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
				</if>
				<if test="creator!= null and creator!= '' ">
					AND su.user_name like CONCAT(CONCAT('%',#{creator,jdbcType=VARCHAR}),'%')
				</if>
				<if test="brandName != null and brandName != '' ">
					AND bb.brand_name   like CONCAT(CONCAT('%',#{brandName,jdbcType=VARCHAR}),'%')
				</if>
				<if test="livingName != null and livingName !='' ">
					AND bl.living_name   like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
				</if>
				<if test="planName != null and planName !='' ">
					AND dp.plan_name   like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
				</if>
			</otherwise>
		</choose>
		
	</select>
 	
 	<!--  方案推荐数据 -->
 	<select id="getPlanRecommendedList" resultMap="planRecommendedResultMap" parameterType="com.nork.design.model.DesignPlanRecommended">
			
			<if test="designRecommendedStyleIdTop!= null and designRecommendedStyleIdTop!= 0 ">
				SELECT * FROM (
			</if>
				SELECT
				dp.id AS planRecommendedId,
				dp.plan_id,
				rrp.pic_path AS cover_path,
				dp.plan_name,
				dp.is_release,
				dpp.gmt_modified,
				dp.gmt_create,
				su.user_name AS 'creator',
				sc.space_areas,
				bps. NAME AS 'style_name',
				sc.space_function_id,
				dp.release_time,
				dp.living_id,
				dp.house_id,
				dp.remark,
				dp.plan_source,
				dp.is_default_decorate,
				dp.apply_space_areas,
				sd. NAME AS houseTypeName,
			    fr.bid,
			    dp.design_recommended_style_id,
			    scs.space_code AS space_code,
		        dp.group_primary_id,
                <!-- sd2.name as decorateTypeName, -->
                <!-- pdp.id as desoratePriceId, -->
                <!-- pdp.decorate_price as decoratePrice, -->
		        dp.charge_type,
		        dp.plan_price,
                dp.company_id,
				CASE WHEN dp.id is null THEN 1
				<if test="areaValue!= null and areaValue!='' ">
					WHEN sc.space_areas &gt;  #{areaValue,jdbcType=VARCHAR} THEN (sc.space_areas - #{areaValue,jdbcType=VARCHAR})
				</if>
				ELSE 2 END AS sort_type
			from design_plan_recommended AS dp
			<!--添加平台过滤-->
			LEFT JOIN design_plan_2b_platform AS dpp ON dpp.plan_id = dp.id

        left join
        (SELECT fid,recommendId,bid from design_plan_recommend_favorite_ref where status = 1 and fid in
        (SELECT bid from sys_business_favorite where userId =#{userId}) ) AS fr ON (fr.recommendId = dp.id)
        LEFT JOIN sys_user  su  ON dp.user_id = su.id AND su.is_deleted = 0
        LEFT JOIN  res_render_pic rrp ON dp.cover_pic_id = rrp.id AND rrp.is_deleted = 0 AND rrp.plan_recommended_id IS NOT NULL
        LEFT JOIN design_plan_brand dpb  ON dp.id = dpb.plan_id and dpb.is_deleted = 0
        LEFT JOIN  base_brand   AS bb   ON dpb.brand_id = bb.id AND bb.is_deleted = 0
        LEFT JOIN design_templet AS dt  ON (dp.design_template_id = dt.id)
        LEFT JOIN  space_common   sc   ON (sc.id = dt.space_common_id AND sc.is_deleted = 0)
        LEFT JOIN space_common scs ON dp.space_Common_Id =scs.id AND scs.is_deleted =0
        <if test="livingName != null and livingName !='' ">
            LEFT JOIN (SELECT standard_space_id,house_id from house_space where is_deleted = 0)as hs ON (hs.standard_space_id = sc.id)
            LEFT JOIN (SELECT id,living_id from base_house where is_deleted = 0) AS bh ON (hs.house_id = bh.id)
            LEFT JOIN (SELECT id,living_name FROM base_living ) as bl ON (bl.id = bh.living_id)
        </if>
        LEFT JOIN base_product_style AS bps ON (bps.id = dp.design_recommended_style_id)
        LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND type = 'houseType' ) AS sd ON (sc.space_function_id = sd.VALUE)
		LEFT JOIN plan_decorate_price pdp on pdp.plan_recommend_id = dp.id
        left join sys_dictionary sd2 on sd2.value = pdp.decorate_price_type and sd2.type = 'decorateType'

		WHERE
            dp.is_deleted = 0
        <!--添加平台过滤-->
			<if test="platformId != null">
				AND dpp.platform_id = #{platformId,jdbcType=INTEGER} AND dpp.putaway_state = 1 AND dpp.allot_state = 1
			</if>
		<!-- 	如果是审核管理员	 -->
		<if test="checkAdministrator != null and checkAdministrator == 'yes' ">
			<if test="spaceFunctionIds != null and spaceFunctionIds.size() >0">
				AND	sc.space_function_id in 
				<foreach collection="spaceFunctionIds" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</if>

		<!-- 	如果不是审核管理员	 -->
		<if test="checkAdministrator == null or checkAdministrator != 'yes' ">

			<if test="spaceFunctionId!= null">
				AND	sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
			</if>
		</if>

		<if test="planNumber!= null and planNumber!= '' ">
			AND	dp.plan_number = #{planNumber,jdbcType=VARCHAR}
		</if>
		<if test="isRelease != null">
			AND dp.is_release =  #{isRelease,jdbcType=INTEGER}
		</if>


		<if test="companyIds != null and companyIds.size() >0">
			AND ( dpb.company_id in
			<foreach collection="companyIds" index="index" item="item" open="(" separator="," close=")">
				#{item}
			</foreach>
			or dp.company_id in
			<foreach collection="companyIds" index="index" item="item" open="(" separator="," close=")">
				#{item}
			</foreach> )
		</if>
		<!--经销商要进行关联品牌的过滤-->
		<if test="brandIds != null and brandIds.size() > 0">
			AND (dpb.brand_id in
			<foreach collection="brandIds" index="index" item="item" open="(" separator="," close=")">
				#{item}
			</foreach>
			or dpb.brand_id is null)
		</if>

		<if test="isReleases != null and isReleases.size() >0">
				AND	dp.is_release in 
				<foreach collection="isReleases" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
		</if>
		<if test="recommendedType != null">
			AND dp.recommended_type = #{recommendedType,jdbcType=INTEGER}
		</if>

        <!--<if test="recommendedType != null and recommendedType == 2">-->
            <!--and LOCATE('ONEKEY',IFNULL(dp.shelf_status,'-')) > 0-->
        <!--</if>-->

		<if test="designRecommendedStyleId!= null">
			AND dp.design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER} 
		</if>
		<!-- 如果没有样板房面积相关数据，则只显示主方案，有样板房面积就显示所有方案 -->
		<!-- 改为如果没有样板房面积相关数据，则显示主方案或没有打组的方案，有样板房面积就显示没有打组的适合的方案和所有主方案
             即所有主方案始终显示，因为产品说组合方案适用所有面积，没有打组的方案：才会有面积过滤  2018.09.08 add by gaoj-->
		and ( dp.group_primary_id = dp.id or ( dp.group_primary_id = 0
		<choose>
			<when test="areaValue== null or areaValue==''">
				) )
			</when>
			<otherwise>
				and (FIND_IN_SET(#{areaValue,jdbcType=VARCHAR},dp.apply_space_areas) or dp.apply_space_areas = '') ) )
			</otherwise>
		</choose>
		<!-- 如果没有样板房面积相关数据，则只显示主方案，有样板房面积就显示所有方案 -->
		<!--<if test="areaValue== null or areaValue==''">-->
			<!--AND (dp.group_primary_id = 0 OR dp.group_primary_id = dp.id)-->
		<!--</if>-->
		<!--<if test="areaValue!= null and areaValue!=''">-->
			<!--AND (FIND_IN_SET(#{areaValue,jdbcType=VARCHAR},dp.apply_space_areas) or dp.apply_space_areas = '')-->
		<!--</if>-->
		<!-- 装修报价类型筛选 -->
		<if test="decoratePriceType != null">
			and pdp.decorate_price_type = #{decoratePriceType,jdbcType=INTEGER}
			<if test="decoratePriceRange != null">
				and pdp.decorate_price_range = #{decoratePriceRange,jdbcType=INTEGER}
			</if>
		</if>
		
		<choose>

			<when test="creator != null and creator != '' and brandName != null and brandName != '' and livingName != null and livingName !='' and planName != null and planName != '' ">

                AND (
                	dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
                    or su.user_name like CONCAT(CONCAT('%',#{creator,jdbcType=VARCHAR}),'%')
                    or bb.brand_name like CONCAT(CONCAT('%',#{brandName,jdbcType=VARCHAR}),'%')
                    or bl.living_name like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
                    or dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
                )
            </when>
			<otherwise>
				<if test="planName!= null and planName!= '' ">
					AND dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
				</if>
				<if test="creator!= null and creator!= '' ">
					AND su.user_name like CONCAT(CONCAT('%',#{creator,jdbcType=VARCHAR}),'%')
				</if>
				<if test="brandName != null and brandName != '' ">
					AND bb.brand_name   like CONCAT(CONCAT('%',#{brandName,jdbcType=VARCHAR}),'%')
				</if>
				<if test="livingName != null and livingName !='' ">
					AND bl.living_name   like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
				</if>
				<if test="planName != null and planName !='' ">
					AND dp.plan_name   like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
				</if>
			</otherwise>
		</choose>
		GROUP BY dp.id
		<if test="designRecommendedStyleIdTop== null or designRecommendedStyleIdTop == 0 ">
			ORDER BY
			<choose>
				<when test="areaValue!= null and areaValue!=''">
					field(dpb.company_id,#{companyId}) DESC,sort_type ASC ,sc.space_areas DESC ,dp.release_time DESC
				</when>
				<otherwise>
					field(dpb.company_id,#{companyId}) DESC , dp.release_time DESC
				</otherwise>
			</choose>
		</if>
		<if test="designRecommendedStyleIdTop!= null and designRecommendedStyleIdTop!= 0 ">
				) as dpTop order by  case when (dpTop.design_recommended_style_id = #{designRecommendedStyleIdTop} )  
				then 0 else 1 end , dpTop.design_recommended_style_id desc
		</if>
		<if test="start !=-1 and limit !=-1"> LIMIT #{start}, #{limit}</if>
 	</select>

 	<resultMap id="planRecommendedResultMap" type="com.nork.design.model.DesignPlanRecommendedResult">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result  column="planRecommendedId" property="planRecommendedId" jdbcType="INTEGER" />
		<result  column="design_template_id" property="designTemplateId" jdbcType="INTEGER" />
		<result  column="plan_id" property="planId" jdbcType="INTEGER" />
		<result  column="plan_name" property="planName" jdbcType="VARCHAR" />
		<result  column="cover_path" property="coverPath" jdbcType="VARCHAR" />
		<result  column="is_release" property="isRelease" jdbcType="INTEGER" /> 
		<result  column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP" /> 
		<result  column="gmt_create" property="gmtCreate" jdbcType="TIMESTAMP" /> 
		<result  column="creator" property="creator" jdbcType="VARCHAR" /> 
		<result  column="space_areas" property="spaceAreas" jdbcType="VARCHAR" /> 
		<result  column="style_name" property="styleName" jdbcType="VARCHAR" /> 
		<result  column="release_time" property="releaseTime" jdbcType="TIMESTAMP" /> 
		<result  column="space_function_id" property="spaceFunctionId" jdbcType="INTEGER" /> 
		<result  column="living_id" property="livingId" jdbcType="INTEGER" /> 
		<result  column="house_id" property="houseId" jdbcType="INTEGER" /> 
		<result  column="remark" property="remark" jdbcType="VARCHAR" /> 
		<result  column="plan_source" property="planSource" jdbcType="VARCHAR" /> 
 		<result  column="is_default_decorate" property="isDefaultDecorate" jdbcType="INTEGER" /> 
 		<result  column="bid" property="bid" jdbcType="VARCHAR" /> 
 		<result  column="favoriteName" property="favoriteName" jdbcType="VARCHAR" />
		<result  column="apply_space_areas" property="applySpaceAreas" jdbcType="VARCHAR" />
		<result  column="space_code" property="spaceCode" jdbcType="VARCHAR" />
		<result  column="group_primary_id" property="groupPrimaryId" jdbcType="INTEGER" />
        <!--<collection property="planDecoratePriceList" ofType="com.nork.design.model.PlanDecoratePriceBO"-->
         <!--javaType="java.util.ArrayList">-->
			<!--<id column="desoratePriceId" property="desoratePriceId" jdbcType="INTEGER"></id>-->
            <!--<result column="decorateTypeName" property="decorateTypeName" jdbcType="VARCHAR"></result>-->
            <!--<result column="decoratePrice" property="decoratePrice" jdbcType="INTEGER"></result>-->
        <!--</collection>-->

		<result  column="charge_type" property="chargeType"/>
		<result  column="plan_price" property="planPrice"/>
        <result  column="company_id" property="companyId"></result>

	</resultMap>
	 <select id="getStatusByIds"   resultType="com.nork.design.model.DesignPlanRecommended">
	 	SELECT plan_id planId,recommended_type recommendedType,is_release isRelease FROM design_plan_recommended where plan_id IN
	 	<foreach item="item" index="index" collection="list" open="(" separator="," close=")">  
 			#{item}  
		</foreach> AND is_deleted=0
	 </select>
	 
	 
	 <!-- 获取该方案推荐的白膜产品的数量，如果大于0那么是m+3 未装修完成的推荐（m+3 是不装修直接渲染的快捷键） -->
     <select id="recommendedDecorateState" resultType="int" parameterType="java.lang.Integer">
	     SELECT count(*) from design_plan_recommended_product  as a 
	     LEFT JOIN  base_product as b on(a.product_id=b.id) where a.plan_recommended_id = #{id}  
	     and a.is_deleted = 0 
	     and b.product_code like  'baimo%'
	     
     </select>
     
     
     <select id="getFavoritePlanRecommendedList" resultMap="planRecommendedResultMap" parameterType="com.nork.design.model.DesignPlanRecommended">
		 SELECT DISTINCT
					dp.id as planRecommendedId,
					dp.plan_id,
					rrp.pic_path AS cover_path,
					dp.plan_name,
					dp.is_release,
					dp.gmt_modified,
					dp.gmt_create,
					su.user_name AS 'creator',
					sc.space_areas,
					bps. NAME AS 'style_name',
					sc.space_function_id,
					dp.release_time,
					dp.living_id,
					dp.house_id,
					dp.remark,
					dp.plan_source,
					dp.is_default_decorate,
					sd.name as houseTypeName,
					fr.bid,
					fr.name as 'favoriteName',
                    dp.group_primary_id,
		 IF(dp.recommended_type=2,true,false) AS isPublic
				FROM  (select dprfr.id,dprfr.bid,sbf.name,dprfr.recommendId from design_plan_recommend_favorite_ref as dprfr
				LEFT JOIN	sys_business_favorite as sbf on(dprfr.fid = sbf.bid) where sbf.userId = #{userId} and dprfr.status = 1
				<if test="favoriteBid!= null and favoriteBid!='' ">
					AND dprfr.fid = #{favoriteBid,jdbcType=VARCHAR}
				</if>
				) AS fr
				LEFT JOIN	(SELECT * from design_plan_recommended where is_deleted = 0  
				<if test="isInternalUser!= null and isInternalUser == 'yes' ">
					AND	is_release in (1,2)
				</if>
				<if test="isInternalUser == null or isInternalUser != 'yes' ">
					AND	is_release = 1
				</if>
				<if test="designRecommendedStyleId!= null">
					AND design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER} 
				</if>
				) AS dp on(fr.recommendId = dp.id)
				LEFT JOIN (SELECT plan_id,brand_id,company_id from design_plan_brand where is_deleted = 0 )AS dpb ON (dp.id = dpb.plan_id)
				LEFT JOIN base_brand AS bb ON (dpb.brand_id = bb.id) 
				LEFT JOIN design_templet AS dt ON ( dp.design_template_id = dt.id )
				LEFT JOIN space_common AS sc ON (sc.id = dt.space_common_id)
				<if test="livingName != null and livingName !='' ">
					LEFT JOIN (SELECT standard_space_id,house_id from house_space where is_deleted = 0)as hs ON (hs.standard_space_id = sc.id)
					LEFT JOIN (SELECT id,living_id from base_house where is_deleted = 0) AS bh ON (hs.house_id = bh.id)
					LEFT JOIN (SELECT id FROM base_living ) as bl ON (bl.id = bh.living_id)
				</if>
				LEFT JOIN (SELECT id,pic_path from res_render_pic where is_deleted = 0 and plan_recommended_id is not null)  AS rrp ON (dp.cover_pic_id = rrp.id)
				LEFT JOIN base_product_style AS bps ON ( bps.id = dp.design_recommended_style_id )
				LEFT JOIN (SELECT id,user_name from sys_user where is_deleted = 0) AS su ON (dp.user_id = su.id)
				LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND type = 'houseType' ) AS sd ON (sc.space_function_id = sd.VALUE)
				WHERE 1=1
		 <if test="companyId != null">
			 and (dpb.company_id = #{companyId,jdbcType=INTEGER} or dpb.company_id = 2501 or dp.company_id = #{companyId,jdbcType=INTEGER} or dp.company_id = 2501)
		 </if>
		<if test="spaceFunctionId!= null">
			and	sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
		</if>
		<if test="livingName!= null and livingName!='' ">
			and bl.living_name   like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
		</if>
		<if test="areaValue!= null and areaValue!='' ">
			and sc.space_areas = #{areaValue,jdbcType=VARCHAR} 
		</if>
		order by fr.id desc
		<if test="start !=-1 and limit !=-1"> LIMIT #{start}, #{limit}</if>
     </select>
     
     
     
     
     
     <select id="getFavoritePlanRecommendedCount" resultType="int" parameterType="com.nork.design.model.DesignPlanRecommended">
	     SELECT DISTINCT
				count(DISTINCT fr.id)
				FROM  (select dprfr.id,dprfr.bid,sbf.name,dprfr.recommendId from design_plan_recommend_favorite_ref as dprfr
				LEFT JOIN	sys_business_favorite as sbf on(dprfr.fid = sbf.bid) where sbf.userId = #{userId} and dprfr.status = 1
				<if test="favoriteBid!= null and favoriteBid!='' ">
					AND dprfr.fid = #{favoriteBid,jdbcType=VARCHAR}
				</if>
				) AS fr
				LEFT JOIN	(SELECT * from design_plan_recommended where is_deleted = 0  
				<if test="isInternalUser!= null and isInternalUser == 'yes' ">
					AND	is_release in (1,2)
				</if>
				<if test="isInternalUser == null or isInternalUser != 'yes' ">
					AND	is_release = 1
				</if>
				<if test="designRecommendedStyleId!= null">
					AND design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER} 
				</if>
				) AS dp on(fr.recommendId = dp.id)
				LEFT JOIN (SELECT plan_id,brand_id,company_id from design_plan_brand where is_deleted = 0 )AS dpb ON (dp.id = dpb.plan_id)
				LEFT JOIN base_brand AS bb ON (dpb.brand_id = bb.id) 
				LEFT JOIN design_templet AS dt ON ( dp.design_template_id = dt.id )
				LEFT JOIN space_common AS sc ON (sc.id = dt.space_common_id)
				<if test="livingName != null and livingName !='' ">
					LEFT JOIN (SELECT standard_space_id,house_id from house_space where is_deleted = 0)as hs ON (hs.standard_space_id = sc.id)
					LEFT JOIN (SELECT id,living_id from base_house where is_deleted = 0) AS bh ON (hs.house_id = bh.id)
					LEFT JOIN (SELECT id FROM base_living ) as bl ON (bl.id = bh.living_id)
				</if>
				LEFT JOIN (SELECT id,pic_path from res_render_pic where is_deleted = 0 and plan_recommended_id is not null)  AS rrp ON (dp.cover_pic_id = rrp.id)
				LEFT JOIN base_product_style AS bps ON ( bps.id = dp.design_recommended_style_id )
				LEFT JOIN (SELECT id,user_name from sys_user where is_deleted = 0) AS su ON (dp.user_id = su.id)
				LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND type = 'houseType' ) AS sd ON (sc.space_function_id = sd.VALUE)
				WHERE 1=1
		 <if test="companyId != null">
			 and (dpb.company_id = #{companyId,jdbcType=INTEGER} or dpb.company_id = 2501 or dp.company_id = #{companyId,jdbcType=INTEGER} or dp.company_id = 2501)
		 </if>
		<if test="spaceFunctionId!= null">
			and	sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
		</if>
		<if test="livingName!= null and livingName!='' ">
			and bl.living_name   like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
		</if>
		<if test="areaValue!= null and areaValue!='' ">
			and sc.space_areas = #{areaValue,jdbcType=VARCHAR} 
		</if>
     
     </select>
   
   
   <select id="getAllFavoritePlanRecommendedCount" resultType="int" parameterType="com.nork.design.model.DesignPlanRecommended">
	    select count(DISTINCT t.id) from(
	    
	     SELECT DISTINCT fr.id as id
				FROM  (select dprfr.id,dprfr.bid,sbf.name,dprfr.recommendId from design_plan_recommend_favorite_ref as dprfr
				LEFT JOIN	sys_business_favorite as sbf on(dprfr.fid = sbf.bid) where sbf.userId = #{userId} and dprfr.status = 1
				<if test="favoriteBid!= null and favoriteBid!='' ">
					AND dprfr.fid = #{favoriteBid,jdbcType=VARCHAR}
				</if>
				) AS fr
				LEFT JOIN	(SELECT * from design_plan_recommended where is_deleted = 0  
				<if test="isInternalUser!= null and isInternalUser == 'yes' ">
					AND	is_release in (1,2)
				</if>
				<if test="isInternalUser == null or isInternalUser != 'yes' ">
					AND	is_release = 1
				</if>
				<if test="designRecommendedStyleId!= null">
					AND design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER} 
				</if>
				) AS dp on(fr.recommendId = dp.id)
				LEFT JOIN (SELECT plan_id,brand_id,company_id from design_plan_brand where is_deleted = 0 )AS dpb ON (dp.id = dpb.plan_id)
				LEFT JOIN base_brand AS bb ON (dpb.brand_id = bb.id) 
				LEFT JOIN design_templet AS dt ON ( dp.design_template_id = dt.id )
				LEFT JOIN space_common AS sc ON (sc.id = dt.space_common_id)
				<if test="livingName != null and livingName !='' ">
					LEFT JOIN (SELECT standard_space_id,house_id from house_space where is_deleted = 0)as hs ON (hs.standard_space_id = sc.id)
					LEFT JOIN (SELECT id,living_id from base_house where is_deleted = 0) AS bh ON (hs.house_id = bh.id)
					LEFT JOIN (SELECT id FROM base_living ) as bl ON (bl.id = bh.living_id)
				</if>
				LEFT JOIN (SELECT id,pic_path from res_render_pic where is_deleted = 0 and plan_recommended_id is not null)  AS rrp ON (dp.cover_pic_id = rrp.id)
				LEFT JOIN base_product_style AS bps ON ( bps.id = dp.design_recommended_style_id )
				LEFT JOIN (SELECT id,user_name from sys_user where is_deleted = 0) AS su ON (dp.user_id = su.id)
				LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND type = 'houseType' ) AS sd ON (sc.space_function_id = sd.VALUE)
				WHERE 1=1
	   <if test="companyId != null">
		   and (dpb.company_id = #{companyId,jdbcType=INTEGER} or dpb.company_id = 2501 or dp.company_id = #{companyId,jdbcType=INTEGER} or dp.company_id = 2501)
	   </if>
		<if test="spaceFunctionId!= null">
			and	sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
		</if>
		<if test="livingName!= null and livingName!='' ">
			and bl.living_name   like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
		</if>
		<if test="areaValue!= null and areaValue!='' ">
			and sc.space_areas = #{areaValue,jdbcType=VARCHAR} 
		</if>
     
     	UNION ALL 
     	
     	SELECT DISTINCT fr.id as id
				FROM  (select dprfr.id,dprfr.bid,sbf.name,dprfr.recommendId from design_plan_recommend_favorite_ref as dprfr
				LEFT JOIN	sys_business_favorite as sbf on(dprfr.fid = sbf.bid) where sbf.userId = #{franchiserId}
				<if test="franchiserFavoriteList!= null and franchiserFavoriteList.size >0 ">
					AND dprfr.fid in
					<foreach collection="franchiserFavoriteList" index="index" item="item" open="(" separator="," close=")">
						#{item.bid}
					</foreach>
				</if>
				) AS fr
				LEFT JOIN	(SELECT * from design_plan_recommended where is_deleted = 0  
				<if test="isInternalUser!= null and isInternalUser == 'yes' ">
					AND	is_release in (1,2)
				</if>
				<if test="isInternalUser == null or isInternalUser != 'yes' ">
					AND	is_release = 1
				</if>
				<if test="designRecommendedStyleId!= null">
					AND design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER} 
				</if>
				) AS dp on(fr.recommendId = dp.id)
				LEFT JOIN (SELECT plan_id,brand_id,company_id from design_plan_brand where is_deleted = 0 )AS dpb ON (dp.id = dpb.plan_id)
				LEFT JOIN base_brand AS bb ON (dpb.brand_id = bb.id) 
				LEFT JOIN design_templet AS dt ON ( dp.design_template_id = dt.id )
				LEFT JOIN space_common AS sc ON (sc.id = dt.space_common_id)
				<if test="livingName != null and livingName !='' ">
					LEFT JOIN (SELECT standard_space_id,house_id from house_space where is_deleted = 0)as hs ON (hs.standard_space_id = sc.id)
					LEFT JOIN (SELECT id,living_id from base_house where is_deleted = 0) AS bh ON (hs.house_id = bh.id)
					LEFT JOIN (SELECT id FROM base_living ) as bl ON (bl.id = bh.living_id)
				</if>
				LEFT JOIN (SELECT id,pic_path from res_render_pic where is_deleted = 0 and plan_recommended_id is not null)  AS rrp ON (dp.cover_pic_id = rrp.id)
				LEFT JOIN base_product_style AS bps ON ( bps.id = dp.design_recommended_style_id )
				LEFT JOIN (SELECT id,user_name from sys_user where is_deleted = 0) AS su ON (dp.user_id = su.id)
				LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND type = 'houseType' ) AS sd ON (sc.space_function_id = sd.VALUE)
				WHERE 1=1
	   <if test="companyId != null">
		   and (dpb.company_id = #{companyId,jdbcType=INTEGER} or dpb.company_id = 2501 or dp.company_id = #{companyId,jdbcType=INTEGER} or dp.company_id = 2501)
	   </if>
		<if test="spaceFunctionId!= null">
			and	sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
		</if>
		<if test="livingName!= null and livingName!='' ">
			and bl.living_name   like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
		</if>
		<if test="areaValue!= null and areaValue!='' ">
			and sc.space_areas = #{areaValue,jdbcType=VARCHAR} 
		</if>
     ) t
     </select>
     
     <!--add by wangHaiLin "dp.group_primary_id"-->
     <select id="getAllFavoritePlanRecommendedList" resultMap="planRecommendedResultMap" parameterType="com.nork.design.model.DesignPlanRecommended">
     	
     	select DISTINCT t.* from (
		 SELECT DISTINCT
					dp.id as planRecommendedId,
					dp.plan_id as plan_id,
					rrp.pic_path AS cover_path,
					dp.plan_name as plan_name,
					dp.is_release as is_release,
					dp.gmt_modified as gmt_modified,
					dp.gmt_create as gmt_create,
					su.user_name AS 'creator',
					sc.space_areas as space_areas,
					bps. NAME AS 'style_name',
					sc.space_function_id as space_function_id,
					dp.release_time as release_time,
					dp.living_id as living_id,
					dp.house_id as house_id,
					dp.remark as remark ,
					dp.plan_source as plan_source,
					dp.is_default_decorate as is_default_decorate,
					sd.name as houseTypeName,
					fr.bid as bid,
                    fr.name as 'favoriteName',
                    dp.group_primary_id,
		            IF(dp.recommended_type=2,true,false) AS isPublic
      			FROM  (select dprfr.id,dprfr.bid,sbf.name,dprfr.recommendId from design_plan_recommend_favorite_ref as dprfr
				LEFT JOIN	sys_business_favorite as sbf on(dprfr.fid = sbf.bid) where sbf.userId = #{userId} and dprfr.status = 1
				<if test="favoriteBid!= null and favoriteBid!='' ">
					AND dprfr.fid = #{favoriteBid,jdbcType=VARCHAR}
				</if>
				) AS fr
				LEFT JOIN	(SELECT * from design_plan_recommended where is_deleted = 0  
				<if test="isInternalUser!= null and isInternalUser == 'yes' ">
					AND	is_release in (1,2)
				</if>
				<if test="isInternalUser == null or isInternalUser != 'yes' ">
					AND	is_release = 1
				</if>
				<if test="designRecommendedStyleId!= null">
					AND design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER} 
				</if>
				) AS dp on(fr.recommendId = dp.id)
				LEFT JOIN (SELECT plan_id,brand_id,company_id from design_plan_brand where is_deleted = 0 )AS dpb ON (dp.id = dpb.plan_id)
				LEFT JOIN base_brand AS bb ON (dpb.brand_id = bb.id) 
				LEFT JOIN design_templet AS dt ON ( dp.design_template_id = dt.id )
				LEFT JOIN space_common AS sc ON (sc.id = dt.space_common_id)
				<if test="livingName != null and livingName !='' ">
					LEFT JOIN (SELECT standard_space_id,house_id from house_space where is_deleted = 0)as hs ON (hs.standard_space_id = sc.id)
					LEFT JOIN (SELECT id,living_id from base_house where is_deleted = 0) AS bh ON (hs.house_id = bh.id)
					LEFT JOIN (SELECT id FROM base_living ) as bl ON (bl.id = bh.living_id)
				</if>
				LEFT JOIN (SELECT id,pic_path from res_render_pic where is_deleted = 0 and plan_recommended_id is not null)  AS rrp ON (dp.cover_pic_id = rrp.id)
				LEFT JOIN base_product_style AS bps ON ( bps.id = dp.design_recommended_style_id )
				LEFT JOIN (SELECT id,user_name from sys_user where is_deleted = 0) AS su ON (dp.user_id = su.id)
				LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND type = 'houseType' ) AS sd ON (sc.space_function_id = sd.VALUE)
				WHERE 1=1
		 <if test="companyId != null">
			 and (dpb.company_id = #{companyId,jdbcType=INTEGER} or dpb.company_id = 2501 or dp.company_id = #{companyId,jdbcType=INTEGER} or dp.company_id = 2501)
		 </if>
		<if test="spaceFunctionId!= null">
			and	sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
		</if>
		<if test="livingName!= null and livingName!='' ">
			and bl.living_name   like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
		</if>
		<if test="areaValue!= null and areaValue!='' ">
			and sc.space_areas = #{areaValue,jdbcType=VARCHAR} 
		</if>
		
		UNION ALL
		
		SELECT DISTINCT
					dp.id as planRecommendedId,
					dp.plan_id as plan_id,
					rrp.pic_path AS cover_path,
					dp.plan_name as plan_name,
					dp.is_release as is_release,
					dp.gmt_modified as gmt_modified,
					dp.gmt_create as gmt_create,
					su.user_name AS 'creator',
					sc.space_areas as space_areas,
					bps. NAME AS 'style_name',
					sc.space_function_id as space_function_id,
					dp.release_time as release_time,
					dp.living_id as living_id,
					dp.house_id as house_id,
					dp.remark as remark ,
					dp.plan_source as plan_source,
					dp.is_default_decorate as is_default_decorate,
					sd.name as houseTypeName,
					fr.bid as bid,
				    fr.name as 'favoriteName',
		 			dp.group_primary_id,
		            IF(dp.recommended_type=2,true,false) AS isPublic
				FROM  (select dprfr.id,dprfr.bid,sbf.name,dprfr.recommendId from design_plan_recommend_favorite_ref as dprfr
				LEFT JOIN	sys_business_favorite as sbf on(dprfr.fid = sbf.bid) where sbf.userId = #{franchiserId}
				 <if test="franchiserFavoriteList!= null and franchiserFavoriteList.size >0 ">
					 AND dprfr.fid in
					 <foreach collection="franchiserFavoriteList" index="index" item="item" open="(" separator="," close=")">
						 #{item.bid}
					 </foreach>
				 </if>
				) AS fr
				LEFT JOIN	(SELECT * from design_plan_recommended where is_deleted = 0  
				<if test="isInternalUser!= null and isInternalUser == 'yes' ">
					AND	is_release in (1,2)
				</if>
				<if test="isInternalUser == null or isInternalUser != 'yes' ">
					AND	is_release = 1
				</if>
				<if test="designRecommendedStyleId!= null">
					AND design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER} 
				</if>
				) AS dp on(fr.recommendId = dp.id)
				LEFT JOIN (SELECT plan_id,brand_id,company_id from design_plan_brand where is_deleted = 0 )AS dpb ON (dp.id = dpb.plan_id)
				LEFT JOIN base_brand AS bb ON (dpb.brand_id = bb.id) 
				LEFT JOIN design_templet AS dt ON ( dp.design_template_id = dt.id )
				LEFT JOIN space_common AS sc ON (sc.id = dt.space_common_id)
				<if test="livingName != null and livingName !='' ">
					LEFT JOIN (SELECT standard_space_id,house_id from house_space where is_deleted = 0)as hs ON (hs.standard_space_id = sc.id)
					LEFT JOIN (SELECT id,living_id from base_house where is_deleted = 0) AS bh ON (hs.house_id = bh.id)
					LEFT JOIN (SELECT id FROM base_living ) as bl ON (bl.id = bh.living_id)
				</if>
				LEFT JOIN (SELECT id,pic_path from res_render_pic where is_deleted = 0 and plan_recommended_id is not null)  AS rrp ON (dp.cover_pic_id = rrp.id)
				LEFT JOIN base_product_style AS bps ON ( bps.id = dp.design_recommended_style_id )
				LEFT JOIN (SELECT id,user_name from sys_user where is_deleted = 0) AS su ON (dp.user_id = su.id)
				LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND type = 'houseType' ) AS sd ON (sc.space_function_id = sd.VALUE)
				WHERE 1=1
		 <if test="companyId != null">
			 and (dpb.company_id = #{companyId,jdbcType=INTEGER} or dpb.company_id = 2501 or dp.company_id = #{companyId,jdbcType=INTEGER} or dp.company_id = 2501)
		 </if>
		<if test="spaceFunctionId!= null">
			and	sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
		</if>
		<if test="livingName!= null and livingName!='' ">
			and bl.living_name   like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
		</if>
		<if test="areaValue!= null and areaValue!='' ">
			and sc.space_areas = #{areaValue,jdbcType=VARCHAR} 
		</if>
		
		) t
		
		<if test="start !=-1 and limit !=-1"> LIMIT #{start}, #{limit}</if>
     </select>

	<!--根据推荐方案查询所有信息-->
	<select id="getAllByRecommendedId" resultMap="planRecommendedResultMap" parameterType="integer">
		SELECT DISTINCT
		dp.id AS planRecommendedId,
		dp.plan_id,
		rrp.pic_path AS cover_path,
		dp.plan_name,
		dp.is_release,
		dp.gmt_modified,
		dp.gmt_create,
		su.user_name AS 'creator',
		sc.space_areas,
		bps. NAME AS 'style_name',
		sc.space_function_id,
		dp.release_time,
		dp.living_id,
		dp.house_id,
		dp.remark,
		dp.plan_source,
		dp.is_default_decorate,
		dp.apply_space_areas,
		sd. NAME AS houseTypeName,
		<!-- fr.bid, -->
		dp.design_recommended_style_id,
		scs.space_code AS space_code,
		dp.group_primary_id

		FROM design_plan_recommended AS dp
		<!--LEFT JOIN
        (SELECT fid,recommendId,bid FROM design_plan_recommend_favorite_ref WHERE STATUS = 1 AND fid IN (SELECT bid FROM sys_business_favorite) ) AS fr ON (fr.recommendId = dp.id) -->
		LEFT JOIN sys_user  su  ON dp.user_id = su.id AND su.is_deleted = 0
		LEFT JOIN  res_render_pic rrp ON dp.cover_pic_id = rrp.id AND rrp.is_deleted = 0 AND rrp.plan_recommended_id IS NOT NULL
		LEFT JOIN design_templet AS dt  ON (dp.design_template_id = dt.id)
		LEFT JOIN  space_common   sc   ON (sc.id = dt.space_common_id AND sc.is_deleted = 0)
		LEFT JOIN space_common scs ON dp.space_Common_Id =scs.id AND scs.is_deleted =0
		LEFT JOIN base_product_style AS bps ON (bps.id = dp.design_recommended_style_id)
		LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND TYPE = 'houseType' ) AS sd ON (sc.space_function_id = sd.VALUE)
		WHERE dp.id = #{planRecommendedId,jdbcType=INTEGER}
	</select>

	<select id="getPlanDecoratePrice" parameterType="integer"
			resultType="com.nork.design.model.PlanDecoratePriceBO">
		SELECT sd.name as decorateTypeName,p.decorate_price as decoratePrice
		FROM plan_decorate_price p,sys_dictionary sd
		WHERE sd.type = 'decorateType'
		AND p.decorate_price_type = sd.value
		AND p.is_deleted = 0
		AND p.plan_recommend_id = #{planRecommendId,jdbcType=INTEGER}
	</select>

	<select id="getPlanDecoratePriceByFullHouseId" parameterType="integer"
			resultType="com.nork.design.model.PlanDecoratePriceBO">
		SELECT sd.name as decorateTypeName,p.decorate_price as decoratePrice
		FROM plan_decorate_price p,sys_dictionary sd
		WHERE sd.type = 'decorateType'
		AND p.decorate_price_type = sd.value
		AND p.is_deleted = 0
		AND p.full_house_id = #{fullHouseId,jdbcType=INTEGER}
	</select>

	<select id="getFullHousePlanCount" resultType="java.lang.Integer"
			parameterType="com.nork.design.model.DesignPlanRecommended">
		select count(DISTINCT(fh.id)) from full_house_design_plan fh
		left join design_plan_2b_platform dpp on dpp.plan_id = fh.id and dpp.design_plan_type = 3
		LEFT JOIN  plan_decorate_price pdp on pdp.full_house_id = fh.id
		where fh.is_deleted = 0
		<!--全屋方案类型不为装进我家和拷贝-->
		and fh.source_type != 2 and fh.source_type != 5
		<!--and fh.open_state = 1-->
		<if test="platformId != null">
			and dpp.platform_id = #{platformId}
			and dpp.putaway_state = 1
			and dpp.allot_state = 1
		</if>
		<if test="companyIds != null and companyIds.size > 0">
			and fh.company_id in
			<foreach collection="companyIds" open="(" close=")" index="index" separator="," item="item">
				#{item}
			</foreach>
		</if>
		<if test="brandIds != null and brandIds.size > 0">
			and
			<foreach collection="brandIds" index="index" separator=" or " item="item" open="(" close=")">
				FIND_IN_SET(#{item},fh.brand_ids)
			</foreach>
		</if>
		<!-- 装修报价类型筛选 -->
		<if test="decoratePriceType != null">
			and pdp.decorate_price_type = #{decoratePriceType,jdbcType=INTEGER}
			<if test="decoratePriceRange != null">
				and pdp.decorate_price_range = #{decoratePriceRange,jdbcType=INTEGER}
			</if>
		</if>

	</select>

    <resultMap id="fullHousePlanListResultMap" type="com.nork.design.model.DesignPlanRecommendedResult">
        <id column="planRecommendedId" property="planRecommendedId" jdbcType="INTEGER"></id>
        <result column="planName" property="planName" jdbcType="VARCHAR"></result>
        <result column="styleName" property="styleName" jdbcType="VARCHAR"></result>
        <result column="gmtCreate" property="gmtCreate" jdbcType="TIMESTAMP"></result>
        <result column="coverPath" property="coverPath" jdbcType="VARCHAR"></result>
        <result column="spaceFunctionId" property="spaceFunctionId" jdbcType="INTEGER"></result>
        <result column="planHouseType" property="planHouseType" jdbcType="INTEGER"></result>
        <result column="gmtModified" property="gmtModified" jdbcType="TIMESTAMP"></result>
        <result column="fullHousePlanUUID" property="fullHousePlanUUID" jdbcType="VARCHAR"></result>
        <collection property="planDecoratePriceList" ofType="com.nork.design.model.PlanDecoratePriceBO">
            <result column="decorateTypeName" property="decorateTypeName" jdbcType="VARCHAR"></result>
            <result column="decoratePrice" property="decoratePrice" jdbcType="INTEGER"></result>
        </collection>
    </resultMap>

	<select id="getFullHousePlanList" parameterType="com.nork.design.model.DesignPlanRecommended"
			resultMap="fullHousePlanListResultMap">
		select
            DISTINCT(fh.id) as planRecommendedId,
			fh.plan_name as planName,
			fh.plan_style_name as styleName,
			fh.gmt_create as gmtCreate,
			fh.vr_resource_uuid as fullHousePlanUUID,
			rrp.pic_path as coverPath,
			sd.value as spaceFunctionId,
			dpp.gmt_modified as gmtModified,
			2 as planHouseType,
            sd2.name decorateTypeName,
            pdp.decorate_price decoratePrice
		from full_house_design_plan fh
		left join design_plan_2b_platform dpp on dpp.plan_id = fh.id and dpp.design_plan_type = 3
		left join res_render_pic rrp on rrp.id = fh.plan_pic_id
		left join sys_dictionary sd on sd.type = 'houseType' and sd.valuekey = 'fullroom'
		LEFT JOIN plan_decorate_price pdp on pdp.full_house_id = fh.id
        left join sys_dictionary sd2 on sd2.value = pdp.decorate_price_type and sd2.type = 'decorateType'

		where fh.is_deleted = 0
		<!--全屋方案类型不为装进我家和拷贝-->
		and fh.source_type != 2 and fh.source_type != 5
		<!--and fh.open_state = 1-->

		<if test="platformId != null">
			and dpp.platform_id = #{platformId}
			and dpp.putaway_state = 1
			and dpp.allot_state = 1
		</if>
		<if test="companyIds != null and companyIds.size > 0">
			and fh.company_id in
			<foreach collection="companyIds" open="(" close=")" index="index" separator="," item="item">
				#{item}
			</foreach>
		</if>
		<if test="brandIds != null and brandIds.size > 0">
			and
			<foreach collection="brandIds" index="index" separator=" or " item="item" open="(" close=")">
				FIND_IN_SET(#{item},fh.brand_ids)
			</foreach>
		</if>
		<!-- 装修报价类型筛选 -->
		<if test="decoratePriceType != null">
			and pdp.decorate_price_type = #{decoratePriceType,jdbcType=INTEGER}
			<if test="decoratePriceRange != null">
				and pdp.decorate_price_range = #{decoratePriceRange,jdbcType=INTEGER}
			</if>
		</if>
		order by fh.open_time desc
		<if test="start !=-1 and limit !=-1"> LIMIT #{start}, #{limit}</if>
	</select>


	<select id="getFullHousePlanAndRecommendPlanCount" resultType="integer"
			parameterType="com.nork.design.model.DesignPlanRecommended">

		select sum(cnt) from (

			select count(1) as cnt from full_house_design_plan fh
			left join design_plan_2b_platform dpp on dpp.plan_id = fh.id and dpp.design_plan_type = 3
			LEFT JOIN  plan_decorate_price pdp on pdp.full_house_id = fh.id
			where fh.is_deleted = 0 and fh.source_type = 1 and fh.open_state = 1
			<if test="platformId != null">
				and dpp.platform_id = #{platformId}
				and dpp.putaway_state = 1
				and dpp.allot_state = 1
			</if>
			<if test="companyIds != null and companyIds.size > 0">
				and fh.company_id in
				<foreach collection="companyIds" open="(" close=")" index="index" separator="," item="item">
					#{item}
				</foreach>
			</if>
			<if test="brandIds != null and brandIds.size > 0">
				<foreach collection="brandIds" index="index" separator=" " item="item">
					and FIND_IN_SET(#{item},fh.brand_ids)
				</foreach>
			</if>
			<!-- 装修报价类型筛选 -->
			<if test="decoratePriceType != null">
				and pdp.decorate_price_type = #{decoratePriceType,jdbcType=INTEGER}
				<if test="decoratePriceRange != null">
					and pdp.decorate_price_range = #{decoratePriceRange,jdbcType=INTEGER}
				</if>
			</if>



			union all



			select  COUNT(DISTINCT dp.id) as cnt
			from design_plan_recommended AS dp
			<!--添加平台过滤-->
			LEFT JOIN design_plan_2b_platform AS dpp ON dpp.plan_id = dp.id
			left join
			(SELECT fid,recommendId,bid from design_plan_recommend_favorite_ref where status = 1 and fid in
			(SELECT bid from sys_business_favorite where userId =#{userId}) ) AS fr ON (fr.recommendId = dp.id)
			LEFT JOIN sys_user  su  ON dp.user_id = su.id AND su.is_deleted = 0
			LEFT JOIN  res_render_pic rrp ON dp.cover_pic_id = rrp.id AND rrp.is_deleted = 0 AND rrp.plan_recommended_id IS NOT NULL
			LEFT JOIN design_plan_brand dpb  ON dp.id = dpb.plan_id and dpb.is_deleted = 0
			LEFT JOIN  base_brand   AS bb   ON dpb.brand_id = bb.id AND bb.is_deleted = 0
			LEFT JOIN design_templet AS dt  ON (dp.design_template_id = dt.id)
			LEFT JOIN  space_common   sc   ON (sc.id = dt.space_common_id AND sc.is_deleted = 0)
			LEFT JOIN space_common scs ON dp.space_Common_Id =scs.id AND scs.is_deleted =0
			<if test="livingName != null and livingName !='' ">
				LEFT JOIN (SELECT standard_space_id,house_id from house_space where is_deleted = 0)as hs ON (hs.standard_space_id = sc.id)
				LEFT JOIN (SELECT id,living_id from base_house where is_deleted = 0) AS bh ON (hs.house_id = bh.id)
				LEFT JOIN (SELECT id,living_name FROM base_living ) as bl ON (bl.id = bh.living_id)
			</if>
			LEFT JOIN base_product_style AS bps ON (bps.id = dp.design_recommended_style_id)
			LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND type = 'houseType' ) AS sd ON (sc.space_function_id = sd.VALUE)
			LEFT JOIN  plan_decorate_price pdp on pdp.plan_recommend_id = dp.id

			WHERE
			dp.is_deleted = 0

			<!--添加平台过滤-->
			<if test="platformId != null">
				AND dpp.platform_id = #{platformId,jdbcType=INTEGER} AND dpp.putaway_state = 1 AND dpp.allot_state = 1
			</if>
			<!-- 	如果是审核管理员	 -->
			<if test="checkAdministrator != null and checkAdministrator == 'yes' ">
				<if test="spaceFunctionIds != null and spaceFunctionIds.size() >0">
					AND	sc.space_function_id in
					<foreach collection="spaceFunctionIds" index="index" item="item" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<!-- 	如果不是审核管理员	 -->
			<if test="checkAdministrator == null or checkAdministrator != 'yes' ">

				<if test="spaceFunctionId!= null">
					AND	sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
				</if>
			</if>
			<!-- 如果没有样板房面积相关数据，则只显示主方案，有样板房面积就显示所有方案 -->
			<if test="areaValue== null or areaValue==''">
				AND (dp.group_primary_id = 0 OR dp.group_primary_id = dp.id)
			</if>
			<if test="planNumber!= null and planNumber!= '' ">
				AND	dp.plan_number = #{planNumber,jdbcType=VARCHAR}
			</if>
			<if test="isRelease != null">
				AND dp.is_release =  #{isRelease,jdbcType=INTEGER}
			</if>
			<if test="companyIds != null and companyIds.size() >0">
				AND ( dpb.company_id in
				<foreach collection="companyIds" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
				or dp.company_id in
				<foreach collection="companyIds" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach> )
			</if>
			<!--经销商要进行关联品牌的过滤-->
			<if test="brandIds != null and brandIds.size() > 0">
				AND ( dpb.brand_id in
				<foreach collection="brandIds" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
				or dpb.brand_id is null)
			</if>
			<if test="isReleases != null and isReleases.size() >0">
				AND	dp.is_release in
				<foreach collection="isReleases" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="recommendedType != null">
				AND dp.recommended_type = #{recommendedType,jdbcType=INTEGER}
			</if>

			<!--	<if test="recommendedType != null and recommendedType == 2">
					and LOCATE('ONEKEY',IFNULL(dp.shelf_status,'-')) > 0
				</if>-->

			<if test="designRecommendedStyleId!= null">
				AND dp.design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER}
			</if>

			<if test="areaValue!= null and areaValue!=''">
				AND (FIND_IN_SET(#{areaValue,jdbcType=VARCHAR},dp.apply_space_areas) or dp.apply_space_areas = '')
			</if>
			<!-- 装修报价类型筛选 -->
			<if test="decoratePriceType != null">
				and pdp.decorate_price_type = #{decoratePriceType,jdbcType=INTEGER}
				<if test="decoratePriceRange != null">
					and pdp.decorate_price_range = #{decoratePriceRange,jdbcType=INTEGER}
				</if>
			</if>
			<choose>

				<when test="creator != null and creator != '' and brandName != null and brandName != '' and livingName != null and livingName !='' and planName != null and planName != '' ">

					AND (
					dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
					or su.user_name like CONCAT(CONCAT('%',#{creator,jdbcType=VARCHAR}),'%')
					or bb.brand_name like CONCAT(CONCAT('%',#{brandName,jdbcType=VARCHAR}),'%')
					or bl.living_name like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
					or dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
					)
				</when>
				<otherwise>
					<if test="planName!= null and planName!= '' ">
						AND dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
					</if>
					<if test="creator!= null and creator!= '' ">
						AND su.user_name like CONCAT(CONCAT('%',#{creator,jdbcType=VARCHAR}),'%')
					</if>
					<if test="brandName != null and brandName != '' ">
						AND bb.brand_name   like CONCAT(CONCAT('%',#{brandName,jdbcType=VARCHAR}),'%')
					</if>
					<if test="livingName != null and livingName !='' ">
						AND bl.living_name   like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
					</if>
					<if test="planName != null and planName !='' ">
						AND dp.plan_name   like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
					</if>
				</otherwise>
			</choose>
		) as allCount

	</select>


	<select id="getFullHousePlanAndRecommendPlanList" resultType="com.nork.design.model.DesignPlanRecommendedResult"
			parameterType="com.nork.design.model.DesignPlanRecommended">
		select * from (

			(select
			fh.id as planRecommendedId,
			fh.plan_name as planName,
			fh.plan_style_name as styleName,
			fh.gmt_create as gmtCreate,
			rrp.pic_path as coverPath,
			sd.value as spaceFunctionId,
			2 as planHouseType
			from full_house_design_plan fh
			left join design_plan_2b_platform dpp on dpp.plan_id = fh.id and dpp.design_plan_type = 3
			left join res_render_pic rrp on rrp.id = fh.plan_pic_id
			LEFT JOIN plan_decorate_price pdp on pdp.full_house_id = fh.id
			left join sys_dictionary sd on sd.type = 'houseType' and sd.valuekey = 'fullroom'
			where fh.is_deleted = 0 and fh.source_type = 1 and fh.open_state = 1
			<if test="platformId != null">and dpp.platform_id = #{platformId}
				and
				dpp.putaway_state = 1
				and dpp.allot_state = 1
			</if>
			<if test="companyIds != null and companyIds.size > 0">
				and fh.company_id in
				<foreach collection="companyIds" open="(" close=")" index="index" separator="," item="item">
					#{item}
				</foreach>
			</if>
			<if test="brandIds != null and brandIds.size > 0">
				<foreach collection="brandIds" index="index" separator=" " item="item">
					and FIND_IN_SET(#{item},fh.brand_ids)
				</foreach>
			</if>
			<!-- 装修报价类型筛选 -->
			<if test="decoratePriceType != null">
				and pdp.decorate_price_type = #{decoratePriceType,jdbcType=INTEGER}
				<if test="decoratePriceRange != null">
					and pdp.decorate_price_range = #{decoratePriceRange,jdbcType=INTEGER}
				</if>
			</if>) t



			union all



			(<if test="designRecommendedStyleIdTop!= null and designRecommendedStyleIdTop!= 0 ">
			SELECT * FROM (
			</if>SELECT DISTINCT
			dp.id AS planRecommendedId,
			dp.plan_id as planId,
			rrp.pic_path AS coverPath,
			dp.plan_name as planName,
			dp.is_release isRelease,
			dp.gmt_modified ,
			dp.gmt_create,
			su.user_name AS 'creator',
			sc.space_areas,
			bps. NAME AS 'style_name',
			sc.space_function_id,
			dp.release_time,
			dp.living_id,
			dp.house_id,
			dp.remark,
			dp.plan_source,
			dp.is_default_decorate,
			dp.apply_space_areas,
			sd. NAME AS houseTypeName,
			fr.bid,
			dp.design_recommended_style_id,
			scs.space_code AS space_code,
			dp.group_primary_id,
			1 as planHouseType,
			CASE WHEN dp.id is null THEN 1
			<if test="areaValue!= null and areaValue!='' ">WHEN sc.space_areas &gt; #{ areaValue,jdbcType=VARCHAR} THEN
				(sc.space_areas - #{areaValue,jdbcType=VARCHAR})
			</if>
				ELSE 2 END AS sort_type
				from design_plan_recommended AS dp
				<!--添加平台过滤-->
				<if test="platformId != null">
					LEFT JOIN design_plan_2b_platform AS dpp ON dpp.plan_id = dp.id
				</if>

			left join
			(SELECT fid,recommendId,bid from design_plan_recommend_favorite_ref where status = 1 and fid in
			(SELECT bid from sys_business_favorite where userId =#{userId}) ) AS fr ON (fr.recommendId = dp.id)
			LEFT JOIN sys_user su ON dp.user_id = su.id AND su.is_deleted = 0
			LEFT JOIN res_render_pic rrp ON dp.cover_pic_id = rrp.id AND rrp.is_deleted = 0 AND rrp.plan_recommended_id
			IS NOT NULL
			LEFT JOIN design_plan_brand dpb ON dp.id = dpb.plan_id and dpb.is_deleted = 0
			LEFT JOIN base_brand AS bb ON dpb.brand_id = bb.id AND bb.is_deleted = 0
			LEFT JOIN design_templet AS dt ON (dp.design_template_id = dt.id)
			LEFT JOIN space_common sc ON (sc.id = dt.space_common_id AND sc.is_deleted = 0)
			LEFT JOIN space_common scs ON dp.space_Common_Id =scs.id AND scs.is_deleted =0
			<if test="livingName != null and livingName !='' ">
				LEFT JOIN (SELECT standard_space_id,house_id from house_space where is_deleted = 0)as hs
				ON (hs.standard_space_id = sc.id)
				LEFT JOIN (SELECT id,living_id from base_house where is_deleted = 0) AS bh ON (hs.house_id = bh.id)
				LEFT JOIN (SELECT id,living_name FROM base_living ) as bl ON (bl.id = bh.living_id)
			</if>
			LEFT JOIN base_product_style AS bps ON (bps.id = dp.design_recommended_style_id)
			LEFT JOIN (SELECT NAME,VALUE FROM sys_dictionary WHERE is_deleted = 0 AND type = 'houseType' ) AS sd
			ON (sc.space_function_id = sd.VALUE)
			LEFT JOIN plan_decorate_price pdp on pdp.plan_recommend_id = dp.id

			WHERE
			dp.is_deleted = 0
			<!--添加平台过滤-->
			<if test="platformId != null">
				AND dpp.platform_id = #{platformId,jdbcType=INTEGER} AND dpp.putaway_state = 1 AND dpp.allot_state = 1
			</if>
			<!-- 	如果是审核管理员	 -->
			<if test="checkAdministrator != null and checkAdministrator == 'yes' ">
				<if test="spaceFunctionIds != null and spaceFunctionIds.size() >0">
					AND	sc.space_function_id in
					<foreach collection="spaceFunctionIds" index="index" item="item" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<!-- 如果没有样板房面积相关数据，则只显示主方案，有样板房面积就显示所有方案 -->
			<if test="areaValue== null or areaValue==''">
				AND (dp.group_primary_id = 0 OR dp.group_primary_id = dp.id)
			</if>
			<!-- 	如果不是审核管理员	 -->
			<if test="checkAdministrator == null or checkAdministrator != 'yes' ">

				<if test="spaceFunctionId!= null">
					AND	sc.space_function_id = #{spaceFunctionId,jdbcType=INTEGER}
				</if>
			</if>

			<if test="planNumber!= null and planNumber!= '' ">
				AND	dp.plan_number = #{planNumber,jdbcType=VARCHAR}
			</if>
			<if test="isRelease != null">
				AND dp.is_release =  #{isRelease,jdbcType=INTEGER}
			</if>


			<if test="companyIds != null and companyIds.size() >0">
				AND ( dpb.company_id in
				<foreach collection="companyIds" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
				or dp.company_id in
				<foreach collection="companyIds" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach> )
			</if>
			<!--经销商要进行关联品牌的过滤-->
			<if test="brandIds != null and brandIds.size() > 0">
				AND (dpb.brand_id in
				<foreach collection="brandIds" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
				or dpb.brand_id is null)
			</if>

			<if test="isReleases != null and isReleases.size() >0">
				AND	dp.is_release in
				<foreach collection="isReleases" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="recommendedType != null">
				AND dp.recommended_type = #{recommendedType,jdbcType=INTEGER}
			</if>

			<!--<if test="recommendedType != null and recommendedType == 2">-->
			<!--and LOCATE('ONEKEY',IFNULL(dp.shelf_status,'-')) > 0-->
			<!--</if>-->

			<if test="designRecommendedStyleId!= null">
				AND dp.design_recommended_style_id = #{designRecommendedStyleId,jdbcType=INTEGER}
			</if>

			<if test="areaValue!= null and areaValue!=''">
				AND (FIND_IN_SET(#{areaValue,jdbcType=VARCHAR},dp.apply_space_areas) or dp.apply_space_areas = '')
			</if>
			<!-- 装修报价类型筛选 -->
			<if test="decoratePriceType != null">
				and pdp.decorate_price_type = #{decoratePriceType,jdbcType=INTEGER}
				<if test="decoratePriceRange != null">
					and pdp.decorate_price_range = #{decoratePriceRange,jdbcType=INTEGER}
				</if>
			</if>

			<choose>

				<when test="creator != null and creator != '' and brandName != null and brandName != '' and livingName != null and livingName !='' and planName != null and planName != '' ">

					AND (
					dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
					or su.user_name like CONCAT(CONCAT('%',#{creator,jdbcType=VARCHAR}),'%')
					or bb.brand_name like CONCAT(CONCAT('%',#{brandName,jdbcType=VARCHAR}),'%')
					or bl.living_name like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
					or dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
					)
				</when>
				<otherwise>
					<if test="planName!= null and planName!= '' ">
						AND dp.plan_name like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
					</if>
					<if test="creator!= null and creator!= '' ">
						AND su.user_name like CONCAT(CONCAT('%',#{creator,jdbcType=VARCHAR}),'%')
					</if>
					<if test="brandName != null and brandName != '' ">
						AND bb.brand_name   like CONCAT(CONCAT('%',#{brandName,jdbcType=VARCHAR}),'%')
					</if>
					<if test="livingName != null and livingName !='' ">
						AND bl.living_name   like CONCAT(CONCAT('%',#{livingName,jdbcType=VARCHAR}),'%')
					</if>
					<if test="planName != null and planName !='' ">
						AND dp.plan_name   like CONCAT(CONCAT('%',#{planName,jdbcType=VARCHAR}),'%')
					</if>
				</otherwise>
			</choose>) t

		) allPlanList

	</select>

	<select id="selectDesignPlanIdsFromRecord" resultType="integer">
		SELECT
		   	  design_plan_id
		   FROM
		   	  user_design_plan_purchase_record
		   WHERE
			   is_deleted = 0 AND
			   user_id = #{userId} and
			   trade_status = 2
	</select>

	<select id="bacchQueryByIds" resultType="com.nork.design.model.DesignPlanRecommended">
		SELECT
		  id,
		  company_id as companyId,
          charge_type as chargeType,
		  plan_price as planPrice
		FROM
		  design_plan_recommended
		WHERE
		   is_deleted = 0 AND
		   id IN
		   <foreach collection="planRecommendedIds" item="id" open="(" separator="," close=")">
			   #{id}
		   </foreach>
	</select>
</mapper>
